<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>GCM-Docs - 8&nbsp; Regions Plugin</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ch09-PersonPropertiesPlugin.html" rel="next">
<link href="./ch07-PeoplePlugin.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Regions Plugin</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">GCM-Docs</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">The General Computation Model (GCM)</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch01-Introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch02-GettingStarted.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch03-StochasticsPlugin.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Stochastics Plugin</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch04-ReportsPlugin.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Reports Plugin</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch05-Properties.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Properties</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch06-GlobalPropertiesPlugin.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Global Properties Plugin</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch07-PeoplePlugin.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">People Plugin</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch08-RegionsPlugin.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Regions Plugin</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch09-PersonPropertiesPlugin.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Person Properties Plugin</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch10-GroupsPlugins.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Groups Plugin</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch11-ResourcesPlugin.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Resources Plugin</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch12-MaterialsPlugin.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Materials Plugin</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch13-PartitionsPlugin.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Partitions Plugin</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#plugin-data-initialization" id="toc-plugin-data-initialization" class="nav-link active" data-scroll-target="#plugin-data-initialization"><span class="toc-section-number">8.1</span>  Plugin Data Initialization</a></li>
  <li><a href="#plugin-behavior" id="toc-plugin-behavior" class="nav-link" data-scroll-target="#plugin-behavior"><span class="toc-section-number">8.2</span>  Plugin Behavior</a></li>
  <li><a href="#data-manager" id="toc-data-manager" class="nav-link" data-scroll-target="#data-manager"><span class="toc-section-number">8.3</span>  Data Manager</a></li>
  <li><a href="#example-code-lesson-15" id="toc-example-code-lesson-15" class="nav-link" data-scroll-target="#example-code-lesson-15"><span class="toc-section-number">8.4</span>  Example Code (Lesson 15)</a></li>
  <li><a href="#the-actors" id="toc-the-actors" class="nav-link" data-scroll-target="#the-actors"><span class="toc-section-number">8.5</span>  The actors</a></li>
  <li><a href="#inspecting-the-output" id="toc-inspecting-the-output" class="nav-link" data-scroll-target="#inspecting-the-output"><span class="toc-section-number">8.6</span>  Inspecting the output</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Regions Plugin</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">

</div>
<p>The regions plugin manages the assignment of people to regions. As such, it is dependent on the people plugin. A region does not have an associated geo-location and does not specifically designate a county, state or any other regional concept. The interpretation of what defines a region is left to the modeler, although it will usually represent some sort of contiguous land area. When the regions plugin is being used, each person has a region association at all times and regions can be associated with zero to many people. Regions may also have a set of associated property values that can be dynamically defined. Regions are identified via the RegionId marker interface that does not define any methods. It is left to the modeler to implement a RegionId data type. When the number of regions is fixed and relatively small this can be accomplished via an enumeration. For larger or dynamic sets of region id values it is typical to implement a simple immutable class that wraps an integer.</p>
<section id="plugin-data-initialization" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="plugin-data-initialization"><span class="header-section-number">8.1</span> Plugin Data Initialization</h2>
<p>The plugin is initialized using a RegionsPluginData object that collects person to region assignments and region property values.</p>
</section>
<section id="plugin-behavior" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="plugin-behavior"><span class="header-section-number">8.2</span> Plugin Behavior</h2>
<p>The plugin adds a single data manager to the simulation as an instance of the RegionsDataManager that is initialized with the RegionsPluginData.</p>
</section>
<section id="data-manager" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="data-manager"><span class="header-section-number">8.3</span> Data Manager</h2>
<p>The data manager controls regions, their properties and the assignment of people to those regions. The data manager provides public methods that:</p>
<ul>
<li>Add a region</li>
<li>Define a region property</li>
<li>Set a region property value</li>
<li>Move a person from one region to another</li>
<li>Answer various questions about:
<ul>
<li>Person membership in regions</li>
<li>Region property values</li>
</ul></li>
</ul>
<p>The data manager also produces observable events:</p>
<ul>
<li>PersonRegionUpdateEvent – when a person is moved from one region to another</li>
<li>RegionAdditionEvent – when a region is added to the simulation</li>
<li>RegionPropertyDefintionEvent – when a new region property is defined</li>
<li>RegionPropertyUpdateEvent – when a region property value is assigned</li>
</ul>
</section>
<section id="example-code-lesson-15" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="example-code-lesson-15"><span class="header-section-number">8.4</span> Example Code (Lesson 15)</h2>
<p>Example_15.java shows the use of the regions plugin. In it we will examine</p>
<ul>
<li>The initialization of the regions plugin</li>
<li>The movement of people between regions</li>
<li>The dynamic addition of regions</li>
<li>The dynamic addition of region properties</li>
<li>The update of region property values</li>
</ul>
<p>The example includes five plugins:</p>
<ul>
<li>Regions Plugin– (GCM core plugin) used to manage regions, their properties and person membership in regions</li>
<li>People plugin – (GCM core plugin) used to manage people</li>
<li>Stochastics plugin – (GCM core plugin) used to generate random numbers used in various decisions</li>
<li>Model plugin – (local plugin) used to introduce three actors that will:
<ul>
<li>Move people between regions</li>
<li>Create new regions</li>
<li>Vaccinate people, reacting to changes in region properties</li>
</ul></li>
<li>Vaccine plugin – (local plugin) used to track vaccinations for each person</li>
</ul>
<p>The example’s main method starts in <a href="#lst-regions_plugin_example_15_main">Code Block&nbsp;<span>8.1</span></a> by creating an instance of the example class rather than building the experiment directly since this example is somewhat more complex than previous examples.</p>
<div class="cell">
<div id="lst-regions_plugin_example_15_main" class="listing">
<p>Code Block&nbsp;8.1: Executing example 15 with an output directory.</p>
<div class="sourceCode cell-code" id="lst-regions_plugin_example_15_main" data-lst-cap="Executing example 15 with an output directory."><pre class="sourceCode numberSource java number-lines code-with-copy"><code class="sourceCode java"><span id="lst-regions_plugin_example_15_main-1"><a href="#lst-regions_plugin_example_15_main-1"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span><span class="op">(</span><span class="bu">String</span><span class="op">[]</span> args<span class="op">)</span> <span class="kw">throws</span> <span class="bu">IOException</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_example_15_main-2"><a href="#lst-regions_plugin_example_15_main-2"></a>    <span class="cf">if</span> <span class="op">(</span>args<span class="op">.</span><span class="fu">length</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_example_15_main-3"><a href="#lst-regions_plugin_example_15_main-3"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">RuntimeException</span><span class="op">(</span><span class="st">"One output directory argument is required"</span><span class="op">);</span></span>
<span id="lst-regions_plugin_example_15_main-4"><a href="#lst-regions_plugin_example_15_main-4"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_example_15_main-5"><a href="#lst-regions_plugin_example_15_main-5"></a>    Path outputDirectory <span class="op">=</span> Paths<span class="op">.</span><span class="fu">get</span><span class="op">(</span>args<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="lst-regions_plugin_example_15_main-6"><a href="#lst-regions_plugin_example_15_main-6"></a>    <span class="cf">if</span> <span class="op">(!</span>Files<span class="op">.</span><span class="fu">exists</span><span class="op">(</span>outputDirectory<span class="op">))</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_example_15_main-7"><a href="#lst-regions_plugin_example_15_main-7"></a>        Files<span class="op">.</span><span class="fu">createDirectory</span><span class="op">(</span>outputDirectory<span class="op">);</span></span>
<span id="lst-regions_plugin_example_15_main-8"><a href="#lst-regions_plugin_example_15_main-8"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_example_15_main-9"><a href="#lst-regions_plugin_example_15_main-9"></a>        <span class="cf">if</span> <span class="op">(!</span>Files<span class="op">.</span><span class="fu">isDirectory</span><span class="op">(</span>outputDirectory<span class="op">))</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_example_15_main-10"><a href="#lst-regions_plugin_example_15_main-10"></a>            <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">IOException</span><span class="op">(</span><span class="st">"Provided path is not a directory"</span><span class="op">);</span></span>
<span id="lst-regions_plugin_example_15_main-11"><a href="#lst-regions_plugin_example_15_main-11"></a>        <span class="op">}</span></span>
<span id="lst-regions_plugin_example_15_main-12"><a href="#lst-regions_plugin_example_15_main-12"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_example_15_main-13"><a href="#lst-regions_plugin_example_15_main-13"></a></span>
<span id="lst-regions_plugin_example_15_main-14"><a href="#lst-regions_plugin_example_15_main-14"></a>    <span class="kw">new</span> <span class="fu">Example_15</span><span class="op">(</span>outputDirectory<span class="op">).</span><span class="fu">execute</span><span class="op">();</span></span>
<span id="lst-regions_plugin_example_15_main-15"><a href="#lst-regions_plugin_example_15_main-15"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>The execution method first gathers together the five plugins in <a href="#lst-regions_plugin_example_15_execute">Code Block&nbsp;<span>8.2</span></a>:</p>
<div class="cell">
<div id="lst-regions_plugin_example_15_execute" class="listing">
<p>Code Block&nbsp;8.2: The various plugins are gathered from their initial data.</p>
<div class="sourceCode cell-code" id="lst-regions_plugin_example_15_execute" data-lst-cap="The various plugins are gathered from their initial data."><pre class="sourceCode numberSource java number-lines code-with-copy"><code class="sourceCode java"><span id="lst-regions_plugin_example_15_execute-1"><a href="#lst-regions_plugin_example_15_execute-1"></a><span class="kw">private</span> <span class="dt">void</span> <span class="fu">execute</span><span class="op">()</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_example_15_execute-2"><a href="#lst-regions_plugin_example_15_execute-2"></a>    <span class="co">/*</span></span>
<span id="lst-regions_plugin_example_15_execute-3"><a href="#lst-regions_plugin_example_15_execute-3"></a><span class="co">         * Create person ids and region ids that are shared across the plugins</span></span>
<span id="lst-regions_plugin_example_15_execute-4"><a href="#lst-regions_plugin_example_15_execute-4"></a><span class="co">         */</span></span>
<span id="lst-regions_plugin_example_15_execute-5"><a href="#lst-regions_plugin_example_15_execute-5"></a>    <span class="fu">initializePeopleAndRegions</span><span class="op">();</span></span>
<span id="lst-regions_plugin_example_15_execute-6"><a href="#lst-regions_plugin_example_15_execute-6"></a></span>
<span id="lst-regions_plugin_example_15_execute-7"><a href="#lst-regions_plugin_example_15_execute-7"></a>    <span class="co">/*</span></span>
<span id="lst-regions_plugin_example_15_execute-8"><a href="#lst-regions_plugin_example_15_execute-8"></a><span class="co">         * Create the reports</span></span>
<span id="lst-regions_plugin_example_15_execute-9"><a href="#lst-regions_plugin_example_15_execute-9"></a><span class="co">         */</span></span>
<span id="lst-regions_plugin_example_15_execute-10"><a href="#lst-regions_plugin_example_15_execute-10"></a></span>
<span id="lst-regions_plugin_example_15_execute-11"><a href="#lst-regions_plugin_example_15_execute-11"></a>    NIOReportItemHandler nioReportItemHandler <span class="op">=</span> <span class="fu">getNIOReportItemHandler</span><span class="op">();</span></span>
<span id="lst-regions_plugin_example_15_execute-12"><a href="#lst-regions_plugin_example_15_execute-12"></a></span>
<span id="lst-regions_plugin_example_15_execute-13"><a href="#lst-regions_plugin_example_15_execute-13"></a>    <span class="co">/*</span></span>
<span id="lst-regions_plugin_example_15_execute-14"><a href="#lst-regions_plugin_example_15_execute-14"></a><span class="co">         * Create the people plugin filled with 1000 people</span></span>
<span id="lst-regions_plugin_example_15_execute-15"><a href="#lst-regions_plugin_example_15_execute-15"></a><span class="co">         */</span></span>
<span id="lst-regions_plugin_example_15_execute-16"><a href="#lst-regions_plugin_example_15_execute-16"></a>    Plugin peoplePlugin <span class="op">=</span> <span class="fu">getPeoplePlugin</span><span class="op">();</span></span>
<span id="lst-regions_plugin_example_15_execute-17"><a href="#lst-regions_plugin_example_15_execute-17"></a></span>
<span id="lst-regions_plugin_example_15_execute-18"><a href="#lst-regions_plugin_example_15_execute-18"></a>    <span class="co">/*</span></span>
<span id="lst-regions_plugin_example_15_execute-19"><a href="#lst-regions_plugin_example_15_execute-19"></a><span class="co">         * Create the region plugin 5 regions, each having a lat and lon and assign the</span></span>
<span id="lst-regions_plugin_example_15_execute-20"><a href="#lst-regions_plugin_example_15_execute-20"></a><span class="co">         * people to random regions.</span></span>
<span id="lst-regions_plugin_example_15_execute-21"><a href="#lst-regions_plugin_example_15_execute-21"></a><span class="co">         * </span></span>
<span id="lst-regions_plugin_example_15_execute-22"><a href="#lst-regions_plugin_example_15_execute-22"></a><span class="co">         */</span></span>
<span id="lst-regions_plugin_example_15_execute-23"><a href="#lst-regions_plugin_example_15_execute-23"></a>    Plugin regionsPlugin <span class="op">=</span> <span class="fu">getRegionsPlugin</span><span class="op">();</span></span>
<span id="lst-regions_plugin_example_15_execute-24"><a href="#lst-regions_plugin_example_15_execute-24"></a></span>
<span id="lst-regions_plugin_example_15_execute-25"><a href="#lst-regions_plugin_example_15_execute-25"></a>    <span class="co">/*</span></span>
<span id="lst-regions_plugin_example_15_execute-26"><a href="#lst-regions_plugin_example_15_execute-26"></a><span class="co">         * create the stochastics plugin and build a dimension with 5 seed values</span></span>
<span id="lst-regions_plugin_example_15_execute-27"><a href="#lst-regions_plugin_example_15_execute-27"></a><span class="co">         */</span></span>
<span id="lst-regions_plugin_example_15_execute-28"><a href="#lst-regions_plugin_example_15_execute-28"></a>    Plugin stochasticsPlugin <span class="op">=</span> <span class="fu">getStochasticsPlugin</span><span class="op">();</span></span>
<span id="lst-regions_plugin_example_15_execute-29"><a href="#lst-regions_plugin_example_15_execute-29"></a>    <span class="bu">Dimension</span> stochasticsDimension <span class="op">=</span> <span class="fu">getStochasticsDimension</span><span class="op">(</span><span class="dv">5</span><span class="op">,</span> randomGenerator<span class="op">.</span><span class="fu">nextLong</span><span class="op">());</span></span>
<span id="lst-regions_plugin_example_15_execute-30"><a href="#lst-regions_plugin_example_15_execute-30"></a></span>
<span id="lst-regions_plugin_example_15_execute-31"><a href="#lst-regions_plugin_example_15_execute-31"></a>    <span class="co">/*</span></span>
<span id="lst-regions_plugin_example_15_execute-32"><a href="#lst-regions_plugin_example_15_execute-32"></a><span class="co">         * Create the vaccine and model plugins</span></span>
<span id="lst-regions_plugin_example_15_execute-33"><a href="#lst-regions_plugin_example_15_execute-33"></a><span class="co">         */</span></span>
<span id="lst-regions_plugin_example_15_execute-34"><a href="#lst-regions_plugin_example_15_execute-34"></a>    Plugin vaccinePlugin <span class="op">=</span> VaccinePlugin<span class="op">.</span><span class="fu">getVaccinePlugin</span><span class="op">();</span></span>
<span id="lst-regions_plugin_example_15_execute-35"><a href="#lst-regions_plugin_example_15_execute-35"></a></span>
<span id="lst-regions_plugin_example_15_execute-36"><a href="#lst-regions_plugin_example_15_execute-36"></a>    Plugin modelPlugin <span class="op">=</span> ModelPlugin<span class="op">.</span><span class="fu">getModelPlugin</span><span class="op">();</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>The first action is to create 1000 people and 5 regions that will be used in the creation of both the people plugin and the regions plugin.</p>
<div class="cell">
<div id="lst-regions_plugin_example_15_intialize_people_regions" class="listing">
<p>Code Block&nbsp;8.3: Lists of initial people and regions are created and will be used to initialize the various plugins.</p>
<div class="sourceCode cell-code" id="lst-regions_plugin_example_15_intialize_people_regions" data-lst-cap="Lists of initial people and regions are created and will be used to initialize the various plugins."><pre class="sourceCode numberSource java number-lines code-with-copy"><code class="sourceCode java"><span id="lst-regions_plugin_example_15_intialize_people_regions-1"><a href="#lst-regions_plugin_example_15_intialize_people_regions-1"></a><span class="kw">private</span> <span class="dt">void</span> <span class="fu">initializePeopleAndRegions</span><span class="op">()</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_example_15_intialize_people_regions-2"><a href="#lst-regions_plugin_example_15_intialize_people_regions-2"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">1000</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_example_15_intialize_people_regions-3"><a href="#lst-regions_plugin_example_15_intialize_people_regions-3"></a>        initialPeople<span class="op">.</span><span class="fu">add</span><span class="op">(</span><span class="kw">new</span> <span class="fu">PersonId</span><span class="op">(</span>i<span class="op">));</span></span>
<span id="lst-regions_plugin_example_15_intialize_people_regions-4"><a href="#lst-regions_plugin_example_15_intialize_people_regions-4"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_example_15_intialize_people_regions-5"><a href="#lst-regions_plugin_example_15_intialize_people_regions-5"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">5</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_example_15_intialize_people_regions-6"><a href="#lst-regions_plugin_example_15_intialize_people_regions-6"></a>        initialRegions<span class="op">.</span><span class="fu">add</span><span class="op">(</span><span class="kw">new</span> <span class="bu">Region</span><span class="op">(</span>i<span class="op">));</span></span>
<span id="lst-regions_plugin_example_15_intialize_people_regions-7"><a href="#lst-regions_plugin_example_15_intialize_people_regions-7"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_example_15_intialize_people_regions-8"><a href="#lst-regions_plugin_example_15_intialize_people_regions-8"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>The regions plugin defines a region id with a marker interface. Marker interfaces are used to differentiate arguments and reduce variable type ambiguities while not imposing any particular implementation on the modeler. Region ids might reasonably be implemented as integer based identifiers or as strings that represent place names. In this example we will implement the region ids with an integer based class, the Region (<a href="#lst-regions_plugin_implementing_regionId">Code Block&nbsp;<span>8.4</span></a>), which is a boiler-plate wrapper around an int id value.</p>
<div class="cell">
<div id="lst-regions_plugin_implementing_regionId" class="listing">
<p>Code Block&nbsp;8.4: The region id is implemented as a wrapper class of int.</p>
<div class="sourceCode cell-code" id="lst-regions_plugin_implementing_regionId" data-lst-cap="The region id is implemented as a wrapper class of int."><pre class="sourceCode numberSource java number-lines code-with-copy"><code class="sourceCode java"><span id="lst-regions_plugin_implementing_regionId-1"><a href="#lst-regions_plugin_implementing_regionId-1"></a><span class="kw">public</span> <span class="dt">final</span> <span class="kw">class</span> <span class="bu">Region</span> <span class="kw">implements</span> RegionId <span class="op">{</span></span>
<span id="lst-regions_plugin_implementing_regionId-2"><a href="#lst-regions_plugin_implementing_regionId-2"></a></span>
<span id="lst-regions_plugin_implementing_regionId-3"><a href="#lst-regions_plugin_implementing_regionId-3"></a>    <span class="kw">private</span> <span class="dt">final</span> <span class="dt">int</span> id<span class="op">;</span></span>
<span id="lst-regions_plugin_implementing_regionId-4"><a href="#lst-regions_plugin_implementing_regionId-4"></a></span>
<span id="lst-regions_plugin_implementing_regionId-5"><a href="#lst-regions_plugin_implementing_regionId-5"></a>    <span class="co">/**</span></span>
<span id="lst-regions_plugin_implementing_regionId-6"><a href="#lst-regions_plugin_implementing_regionId-6"></a>     <span class="co">*</span> Constructs the region</span>
<span id="lst-regions_plugin_implementing_regionId-7"><a href="#lst-regions_plugin_implementing_regionId-7"></a>     <span class="co">*</span> </span>
<span id="lst-regions_plugin_implementing_regionId-8"><a href="#lst-regions_plugin_implementing_regionId-8"></a><span class="co">     * @</span>throws ContractException</span>
<span id="lst-regions_plugin_implementing_regionId-9"><a href="#lst-regions_plugin_implementing_regionId-9"></a>     <span class="co">*</span>                           <span class="kw">&lt;li&gt;</span><span class="co">{@</span>linkplain ModelError<span class="co">#</span>NEGATIVE_REGION_ID<span class="co">}</span><span class="kw">&lt;/li&gt;</span></span>
<span id="lst-regions_plugin_implementing_regionId-10"><a href="#lst-regions_plugin_implementing_regionId-10"></a>     <span class="co">*/</span></span>
<span id="lst-regions_plugin_implementing_regionId-11"><a href="#lst-regions_plugin_implementing_regionId-11"></a>    <span class="kw">public</span> <span class="bu">Region</span><span class="op">(</span><span class="dt">int</span> id<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_implementing_regionId-12"><a href="#lst-regions_plugin_implementing_regionId-12"></a>        <span class="cf">if</span> <span class="op">(</span>id <span class="op">&lt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_implementing_regionId-13"><a href="#lst-regions_plugin_implementing_regionId-13"></a>            <span class="cf">throw</span> <span class="kw">new</span> <span class="fu">ContractException</span><span class="op">(</span>ModelError<span class="op">.</span><span class="fu">NEGATIVE_REGION_ID</span><span class="op">);</span></span>
<span id="lst-regions_plugin_implementing_regionId-14"><a href="#lst-regions_plugin_implementing_regionId-14"></a>        <span class="op">}</span></span>
<span id="lst-regions_plugin_implementing_regionId-15"><a href="#lst-regions_plugin_implementing_regionId-15"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">id</span> <span class="op">=</span> id<span class="op">;</span></span>
<span id="lst-regions_plugin_implementing_regionId-16"><a href="#lst-regions_plugin_implementing_regionId-16"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_implementing_regionId-17"><a href="#lst-regions_plugin_implementing_regionId-17"></a></span>
<span id="lst-regions_plugin_implementing_regionId-18"><a href="#lst-regions_plugin_implementing_regionId-18"></a>    <span class="kw">public</span> <span class="dt">int</span> <span class="fu">getValue</span><span class="op">()</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_implementing_regionId-19"><a href="#lst-regions_plugin_implementing_regionId-19"></a>        <span class="cf">return</span> id<span class="op">;</span></span>
<span id="lst-regions_plugin_implementing_regionId-20"><a href="#lst-regions_plugin_implementing_regionId-20"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_implementing_regionId-21"><a href="#lst-regions_plugin_implementing_regionId-21"></a></span>
<span id="lst-regions_plugin_implementing_regionId-22"><a href="#lst-regions_plugin_implementing_regionId-22"></a>    <span class="at">@Override</span></span>
<span id="lst-regions_plugin_implementing_regionId-23"><a href="#lst-regions_plugin_implementing_regionId-23"></a>    <span class="kw">public</span> <span class="dt">int</span> <span class="fu">hashCode</span><span class="op">()</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_implementing_regionId-24"><a href="#lst-regions_plugin_implementing_regionId-24"></a>        <span class="cf">return</span> id<span class="op">;</span></span>
<span id="lst-regions_plugin_implementing_regionId-25"><a href="#lst-regions_plugin_implementing_regionId-25"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_implementing_regionId-26"><a href="#lst-regions_plugin_implementing_regionId-26"></a></span>
<span id="lst-regions_plugin_implementing_regionId-27"><a href="#lst-regions_plugin_implementing_regionId-27"></a>    <span class="at">@Override</span></span>
<span id="lst-regions_plugin_implementing_regionId-28"><a href="#lst-regions_plugin_implementing_regionId-28"></a>    <span class="kw">public</span> <span class="dt">boolean</span> <span class="fu">equals</span><span class="op">(</span><span class="bu">Object</span> obj<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_implementing_regionId-29"><a href="#lst-regions_plugin_implementing_regionId-29"></a>        <span class="cf">if</span> <span class="op">(</span><span class="kw">this</span> <span class="op">==</span> obj<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_implementing_regionId-30"><a href="#lst-regions_plugin_implementing_regionId-30"></a>            <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="lst-regions_plugin_implementing_regionId-31"><a href="#lst-regions_plugin_implementing_regionId-31"></a>        <span class="op">}</span></span>
<span id="lst-regions_plugin_implementing_regionId-32"><a href="#lst-regions_plugin_implementing_regionId-32"></a>        <span class="cf">if</span> <span class="op">(!(</span>obj <span class="kw">instanceof</span> <span class="bu">Region</span><span class="op">))</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_implementing_regionId-33"><a href="#lst-regions_plugin_implementing_regionId-33"></a>            <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="lst-regions_plugin_implementing_regionId-34"><a href="#lst-regions_plugin_implementing_regionId-34"></a>        <span class="op">}</span></span>
<span id="lst-regions_plugin_implementing_regionId-35"><a href="#lst-regions_plugin_implementing_regionId-35"></a>        <span class="bu">Region</span> other <span class="op">=</span> <span class="op">(</span><span class="bu">Region</span><span class="op">)</span> obj<span class="op">;</span></span>
<span id="lst-regions_plugin_implementing_regionId-36"><a href="#lst-regions_plugin_implementing_regionId-36"></a>        <span class="cf">if</span> <span class="op">(</span>id <span class="op">!=</span> other<span class="op">.</span><span class="fu">id</span><span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_implementing_regionId-37"><a href="#lst-regions_plugin_implementing_regionId-37"></a>            <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="lst-regions_plugin_implementing_regionId-38"><a href="#lst-regions_plugin_implementing_regionId-38"></a>        <span class="op">}</span></span>
<span id="lst-regions_plugin_implementing_regionId-39"><a href="#lst-regions_plugin_implementing_regionId-39"></a>        <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="lst-regions_plugin_implementing_regionId-40"><a href="#lst-regions_plugin_implementing_regionId-40"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_implementing_regionId-41"><a href="#lst-regions_plugin_implementing_regionId-41"></a></span>
<span id="lst-regions_plugin_implementing_regionId-42"><a href="#lst-regions_plugin_implementing_regionId-42"></a>    <span class="at">@Override</span></span>
<span id="lst-regions_plugin_implementing_regionId-43"><a href="#lst-regions_plugin_implementing_regionId-43"></a>    <span class="kw">public</span> <span class="bu">String</span> <span class="fu">toString</span><span class="op">()</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_implementing_regionId-44"><a href="#lst-regions_plugin_implementing_regionId-44"></a>        <span class="cf">return</span> <span class="st">"Region_"</span> <span class="op">+</span> id<span class="op">;</span></span>
<span id="lst-regions_plugin_implementing_regionId-45"><a href="#lst-regions_plugin_implementing_regionId-45"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_implementing_regionId-46"><a href="#lst-regions_plugin_implementing_regionId-46"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>The example contains three reports in <a href="#lst-regions_plugin_example_15_nio">Code Block&nbsp;<span>8.5</span></a>:</p>
<ul>
<li>RegionPropertyReport - shows changes to region property values</li>
<li>RegionTransferReport - shows movements of people between regions</li>
<li>VaccinationReport - shows vaccinations of people</li>
</ul>
<div class="cell">
<div id="lst-regions_plugin_example_15_nio" class="listing">
<p>Code Block&nbsp;8.5: The region property, region transfer and vaccination reports are mapped to distinct file names.</p>
<div class="sourceCode cell-code" id="lst-regions_plugin_example_15_nio" data-lst-cap="The region property, region transfer and vaccination reports are mapped to distinct file names."><pre class="sourceCode numberSource java number-lines code-with-copy"><code class="sourceCode java"><span id="lst-regions_plugin_example_15_nio-1"><a href="#lst-regions_plugin_example_15_nio-1"></a><span class="kw">private</span> NIOReportItemHandler <span class="fu">getNIOReportItemHandler</span><span class="op">()</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_example_15_nio-2"><a href="#lst-regions_plugin_example_15_nio-2"></a>    <span class="cf">return</span> NIOReportItemHandler<span class="op">.</span><span class="fu">builder</span><span class="op">()</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_15_nio-3"><a href="#lst-regions_plugin_example_15_nio-3"></a>            <span class="op">.</span><span class="fu">addReport</span><span class="op">(</span>ModelReportLabel<span class="op">.</span><span class="fu">REGION_PROPERTY_REPORT</span><span class="op">,</span> <span class="co">//</span></span>
<span id="lst-regions_plugin_example_15_nio-4"><a href="#lst-regions_plugin_example_15_nio-4"></a>                    outputDirectory<span class="op">.</span><span class="fu">resolve</span><span class="op">(</span><span class="st">"region_property_report.xls"</span><span class="op">))</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_15_nio-5"><a href="#lst-regions_plugin_example_15_nio-5"></a>            <span class="op">.</span><span class="fu">addReport</span><span class="op">(</span>ModelReportLabel<span class="op">.</span><span class="fu">REGION_TRANSFER_REPORT</span><span class="op">,</span> <span class="co">//</span></span>
<span id="lst-regions_plugin_example_15_nio-6"><a href="#lst-regions_plugin_example_15_nio-6"></a>                    outputDirectory<span class="op">.</span><span class="fu">resolve</span><span class="op">(</span><span class="st">"region_transfer_report.xls"</span><span class="op">))</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_15_nio-7"><a href="#lst-regions_plugin_example_15_nio-7"></a>            <span class="op">.</span><span class="fu">addReport</span><span class="op">(</span>ModelReportLabel<span class="op">.</span><span class="fu">VACCINATION</span><span class="op">,</span> <span class="co">//</span></span>
<span id="lst-regions_plugin_example_15_nio-8"><a href="#lst-regions_plugin_example_15_nio-8"></a>                    outputDirectory<span class="op">.</span><span class="fu">resolve</span><span class="op">(</span><span class="st">"vaccine_report.xls"</span><span class="op">))</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_15_nio-9"><a href="#lst-regions_plugin_example_15_nio-9"></a>            <span class="op">.</span><span class="fu">build</span><span class="op">();</span></span>
<span id="lst-regions_plugin_example_15_nio-10"><a href="#lst-regions_plugin_example_15_nio-10"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>The people plugin, <a href="#lst-regions_plugin_example_getting_people_plugin">Code Block&nbsp;<span>8.6</span></a>, is built from the 1000 people created earlier.</p>
<div class="cell">
<div id="lst-regions_plugin_example_getting_people_plugin" class="listing">
<p>Code Block&nbsp;8.6: The people plugin is initialized with the starting populaiton.</p>
<div class="sourceCode cell-code" id="lst-regions_plugin_example_getting_people_plugin" data-lst-cap="The people plugin is initialized with the starting populaiton."><pre class="sourceCode numberSource java number-lines code-with-copy"><code class="sourceCode java"><span id="lst-regions_plugin_example_getting_people_plugin-1"><a href="#lst-regions_plugin_example_getting_people_plugin-1"></a><span class="kw">private</span> Plugin <span class="fu">getPeoplePlugin</span><span class="op">()</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_example_getting_people_plugin-2"><a href="#lst-regions_plugin_example_getting_people_plugin-2"></a>    PeoplePluginData<span class="op">.</span><span class="fu">Builder</span> peoplePluginDataBuilder <span class="op">=</span> PeoplePluginData<span class="op">.</span><span class="fu">builder</span><span class="op">();</span></span>
<span id="lst-regions_plugin_example_getting_people_plugin-3"><a href="#lst-regions_plugin_example_getting_people_plugin-3"></a>    <span class="cf">for</span> <span class="op">(</span>PersonId personId <span class="op">:</span> initialPeople<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_example_getting_people_plugin-4"><a href="#lst-regions_plugin_example_getting_people_plugin-4"></a>        peoplePluginDataBuilder<span class="op">.</span><span class="fu">addPersonRange</span><span class="op">(</span><span class="kw">new</span> <span class="fu">PersonRange</span><span class="op">(</span>personId<span class="op">.</span><span class="fu">getValue</span><span class="op">(),</span> personId<span class="op">.</span><span class="fu">getValue</span><span class="op">()));</span></span>
<span id="lst-regions_plugin_example_getting_people_plugin-5"><a href="#lst-regions_plugin_example_getting_people_plugin-5"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_example_getting_people_plugin-6"><a href="#lst-regions_plugin_example_getting_people_plugin-6"></a>    PeoplePluginData peoplePluginData <span class="op">=</span> peoplePluginDataBuilder<span class="op">.</span><span class="fu">build</span><span class="op">();</span></span>
<span id="lst-regions_plugin_example_getting_people_plugin-7"><a href="#lst-regions_plugin_example_getting_people_plugin-7"></a>    <span class="cf">return</span> PeoplePlugin<span class="op">.</span><span class="fu">getPeoplePlugin</span><span class="op">(</span>peoplePluginData<span class="op">);</span></span>
<span id="lst-regions_plugin_example_getting_people_plugin-8"><a href="#lst-regions_plugin_example_getting_people_plugin-8"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Creating the regions plugin <a href="#lst-regions_plugin_example_getting_regions_plugin">Code Block&nbsp;<span>8.7</span></a> is a bit more involved. First, the five regions created before are added to the plugin. Since the plugin requires that every person always have a region assignment, we assign a randomly selected region to each person. We define the LAT and LON properties to give the regions a geographic location. Notice that the definitions do not have default values since it does not make sense to say a region has a default position. This then will require that we assign specific latitude and longitude values for each region. Later on we will examine adding a new region property definition dynamically as the simulation is running.</p>
<div class="cell">
<div id="lst-regions_plugin_example_getting_regions_plugin" class="listing">
<p>Code Block&nbsp;8.7: The regions plugin is initialized with the starting regions and people, with each person assigned to a randomly selected region. The two region-based reports are also initialized and added to the region plugin’s data.</p>
<div class="sourceCode cell-code" id="lst-regions_plugin_example_getting_regions_plugin" data-lst-cap="The regions plugin is initialized with the starting regions and people, with each person assigned to a randomly selected region. The two region-based reports are also initialized and added to the region plugin's data."><pre class="sourceCode numberSource java number-lines code-with-copy"><code class="sourceCode java"><span id="lst-regions_plugin_example_getting_regions_plugin-1"><a href="#lst-regions_plugin_example_getting_regions_plugin-1"></a><span class="kw">private</span> Plugin <span class="fu">getRegionsPlugin</span><span class="op">()</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-2"><a href="#lst-regions_plugin_example_getting_regions_plugin-2"></a>    <span class="co">// create the region plugin with an initial five regions, each region</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-3"><a href="#lst-regions_plugin_example_getting_regions_plugin-3"></a>    <span class="co">// having 200 people</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-4"><a href="#lst-regions_plugin_example_getting_regions_plugin-4"></a>    RegionsPluginData<span class="op">.</span><span class="fu">Builder</span> regionsPluginDataBuilder <span class="op">=</span> RegionsPluginData<span class="op">.</span><span class="fu">builder</span><span class="op">();</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-5"><a href="#lst-regions_plugin_example_getting_regions_plugin-5"></a>    <span class="cf">for</span> <span class="op">(</span><span class="bu">Region</span> region <span class="op">:</span> initialRegions<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-6"><a href="#lst-regions_plugin_example_getting_regions_plugin-6"></a>        regionsPluginDataBuilder<span class="op">.</span><span class="fu">addRegion</span><span class="op">(</span>region<span class="op">);</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-7"><a href="#lst-regions_plugin_example_getting_regions_plugin-7"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-8"><a href="#lst-regions_plugin_example_getting_regions_plugin-8"></a></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-9"><a href="#lst-regions_plugin_example_getting_regions_plugin-9"></a>    <span class="cf">for</span> <span class="op">(</span>PersonId personId <span class="op">:</span> initialPeople<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-10"><a href="#lst-regions_plugin_example_getting_regions_plugin-10"></a>        <span class="bu">Region</span> region <span class="op">=</span> initialRegions<span class="op">.</span><span class="fu">get</span><span class="op">(</span>randomGenerator<span class="op">.</span><span class="fu">nextInt</span><span class="op">(</span>initialRegions<span class="op">.</span><span class="fu">size</span><span class="op">()));</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-11"><a href="#lst-regions_plugin_example_getting_regions_plugin-11"></a>        regionsPluginDataBuilder<span class="op">.</span><span class="fu">addPerson</span><span class="op">(</span>personId<span class="op">,</span> region<span class="op">);</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-12"><a href="#lst-regions_plugin_example_getting_regions_plugin-12"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-13"><a href="#lst-regions_plugin_example_getting_regions_plugin-13"></a></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-14"><a href="#lst-regions_plugin_example_getting_regions_plugin-14"></a>    PropertyDefinition propertyDefinition <span class="op">=</span> PropertyDefinition<span class="op">.</span><span class="fu">builder</span><span class="op">()</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-15"><a href="#lst-regions_plugin_example_getting_regions_plugin-15"></a>            <span class="op">.</span><span class="fu">setType</span><span class="op">(</span><span class="bu">Double</span><span class="op">.</span><span class="fu">class</span><span class="op">)</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-16"><a href="#lst-regions_plugin_example_getting_regions_plugin-16"></a>            <span class="op">.</span><span class="fu">setPropertyValueMutability</span><span class="op">(</span><span class="kw">false</span><span class="op">)</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-17"><a href="#lst-regions_plugin_example_getting_regions_plugin-17"></a>            <span class="op">.</span><span class="fu">build</span><span class="op">();</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-18"><a href="#lst-regions_plugin_example_getting_regions_plugin-18"></a>    regionsPluginDataBuilder<span class="op">.</span><span class="fu">defineRegionProperty</span><span class="op">(</span>RegionProperty<span class="op">.</span><span class="fu">LAT</span><span class="op">,</span> propertyDefinition<span class="op">);</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-19"><a href="#lst-regions_plugin_example_getting_regions_plugin-19"></a>    regionsPluginDataBuilder<span class="op">.</span><span class="fu">defineRegionProperty</span><span class="op">(</span>RegionProperty<span class="op">.</span><span class="fu">LON</span><span class="op">,</span> propertyDefinition<span class="op">);</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-20"><a href="#lst-regions_plugin_example_getting_regions_plugin-20"></a></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-21"><a href="#lst-regions_plugin_example_getting_regions_plugin-21"></a>    <span class="cf">for</span> <span class="op">(</span><span class="bu">Region</span> region <span class="op">:</span> initialRegions<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-22"><a href="#lst-regions_plugin_example_getting_regions_plugin-22"></a>        regionsPluginDataBuilder<span class="op">.</span><span class="fu">setRegionPropertyValue</span><span class="op">(</span>region<span class="op">,</span> RegionProperty<span class="op">.</span><span class="fu">LAT</span><span class="op">,</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-23"><a href="#lst-regions_plugin_example_getting_regions_plugin-23"></a>                randomGenerator<span class="op">.</span><span class="fu">nextDouble</span><span class="op">()</span> <span class="op">+</span> <span class="fl">45.0</span><span class="op">);</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-24"><a href="#lst-regions_plugin_example_getting_regions_plugin-24"></a>        regionsPluginDataBuilder<span class="op">.</span><span class="fu">setRegionPropertyValue</span><span class="op">(</span>region<span class="op">,</span> RegionProperty<span class="op">.</span><span class="fu">LON</span><span class="op">,</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-25"><a href="#lst-regions_plugin_example_getting_regions_plugin-25"></a>                randomGenerator<span class="op">.</span><span class="fu">nextDouble</span><span class="op">()</span> <span class="op">+</span> <span class="fl">128.0</span><span class="op">);</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-26"><a href="#lst-regions_plugin_example_getting_regions_plugin-26"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-27"><a href="#lst-regions_plugin_example_getting_regions_plugin-27"></a></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-28"><a href="#lst-regions_plugin_example_getting_regions_plugin-28"></a>    RegionsPluginData regionsPluginData <span class="op">=</span> regionsPluginDataBuilder<span class="op">.</span><span class="fu">build</span><span class="op">();</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-29"><a href="#lst-regions_plugin_example_getting_regions_plugin-29"></a></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-30"><a href="#lst-regions_plugin_example_getting_regions_plugin-30"></a>    RegionPropertyReportPluginData regionPropertyReportPluginData <span class="op">=</span> <span class="co">//</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-31"><a href="#lst-regions_plugin_example_getting_regions_plugin-31"></a>            RegionPropertyReportPluginData<span class="op">.</span><span class="fu">builder</span><span class="op">()</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-32"><a href="#lst-regions_plugin_example_getting_regions_plugin-32"></a>                    <span class="op">.</span><span class="fu">setReportLabel</span><span class="op">(</span>ModelReportLabel<span class="op">.</span><span class="fu">REGION_PROPERTY_REPORT</span><span class="op">)</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-33"><a href="#lst-regions_plugin_example_getting_regions_plugin-33"></a>                    <span class="op">.</span><span class="fu">build</span><span class="op">();</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-34"><a href="#lst-regions_plugin_example_getting_regions_plugin-34"></a></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-35"><a href="#lst-regions_plugin_example_getting_regions_plugin-35"></a>    RegionTransferReportPluginData regionTransferReportPluginData <span class="op">=</span> RegionTransferReportPluginData<span class="op">.</span><span class="fu">builder</span><span class="op">()</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-36"><a href="#lst-regions_plugin_example_getting_regions_plugin-36"></a>            <span class="op">.</span><span class="fu">setReportLabel</span><span class="op">(</span>ModelReportLabel<span class="op">.</span><span class="fu">REGION_TRANSFER_REPORT</span><span class="op">)</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-37"><a href="#lst-regions_plugin_example_getting_regions_plugin-37"></a>            <span class="op">.</span><span class="fu">setReportPeriod</span><span class="op">(</span>ReportPeriod<span class="op">.</span><span class="fu">END_OF_SIMULATION</span><span class="op">)</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-38"><a href="#lst-regions_plugin_example_getting_regions_plugin-38"></a>            <span class="op">.</span><span class="fu">build</span><span class="op">();</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-39"><a href="#lst-regions_plugin_example_getting_regions_plugin-39"></a></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-40"><a href="#lst-regions_plugin_example_getting_regions_plugin-40"></a>    <span class="cf">return</span> RegionsPlugin<span class="op">.</span><span class="fu">builder</span><span class="op">()</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-41"><a href="#lst-regions_plugin_example_getting_regions_plugin-41"></a>            <span class="op">.</span><span class="fu">setRegionsPluginData</span><span class="op">(</span>regionsPluginData<span class="op">)</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-42"><a href="#lst-regions_plugin_example_getting_regions_plugin-42"></a>            <span class="op">.</span><span class="fu">setRegionPropertyReportPluginData</span><span class="op">(</span>regionPropertyReportPluginData<span class="op">)</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-43"><a href="#lst-regions_plugin_example_getting_regions_plugin-43"></a>            <span class="op">.</span><span class="fu">setRegionTransferReportPluginData</span><span class="op">(</span>regionTransferReportPluginData<span class="op">)</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-44"><a href="#lst-regions_plugin_example_getting_regions_plugin-44"></a>            <span class="op">.</span><span class="fu">getRegionsPlugin</span><span class="op">();</span></span>
<span id="lst-regions_plugin_example_getting_regions_plugin-45"><a href="#lst-regions_plugin_example_getting_regions_plugin-45"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Adding the stochastics plugin with a corresponding dimension that will create five scenarios proceeds in the usual way in <a href="#lst-regions_plugin_example_15_stochastics">Code Block&nbsp;<span>8.8</span></a>:</p>
<div class="cell">
<div id="lst-regions_plugin_example_15_stochastics" class="listing">
<p>Code Block&nbsp;8.8: The stochastics plugin is initialized with a random seed value. A dimension is added to add new seeds to the resulting scenarios.</p>
<div class="sourceCode cell-code" id="lst-regions_plugin_example_15_stochastics" data-lst-cap="The stochastics plugin is initialized with a random seed value.  A dimension is added to add new seeds to the resulting scenarios."><pre class="sourceCode numberSource java number-lines code-with-copy"><code class="sourceCode java"><span id="lst-regions_plugin_example_15_stochastics-1"><a href="#lst-regions_plugin_example_15_stochastics-1"></a><span class="kw">private</span> Plugin <span class="fu">getStochasticsPlugin</span><span class="op">()</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_example_15_stochastics-2"><a href="#lst-regions_plugin_example_15_stochastics-2"></a></span>
<span id="lst-regions_plugin_example_15_stochastics-3"><a href="#lst-regions_plugin_example_15_stochastics-3"></a>    WellState wellState <span class="op">=</span> WellState<span class="op">.</span><span class="fu">builder</span><span class="op">().</span><span class="fu">setSeed</span><span class="op">(</span>randomGenerator<span class="op">.</span><span class="fu">nextLong</span><span class="op">()).</span><span class="fu">build</span><span class="op">();</span></span>
<span id="lst-regions_plugin_example_15_stochastics-4"><a href="#lst-regions_plugin_example_15_stochastics-4"></a>    StochasticsPluginData stochasticsPluginData <span class="op">=</span> StochasticsPluginData<span class="op">.</span><span class="fu">builder</span><span class="op">()</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_15_stochastics-5"><a href="#lst-regions_plugin_example_15_stochastics-5"></a>            <span class="op">.</span><span class="fu">setMainRNGState</span><span class="op">(</span>wellState<span class="op">).</span><span class="fu">build</span><span class="op">();</span></span>
<span id="lst-regions_plugin_example_15_stochastics-6"><a href="#lst-regions_plugin_example_15_stochastics-6"></a>    <span class="cf">return</span> StochasticsPlugin<span class="op">.</span><span class="fu">getStochasticsPlugin</span><span class="op">(</span>stochasticsPluginData<span class="op">);</span></span>
<span id="lst-regions_plugin_example_15_stochastics-7"><a href="#lst-regions_plugin_example_15_stochastics-7"></a><span class="op">}</span></span>
<span id="lst-regions_plugin_example_15_stochastics-8"><a href="#lst-regions_plugin_example_15_stochastics-8"></a></span>
<span id="lst-regions_plugin_example_15_stochastics-9"><a href="#lst-regions_plugin_example_15_stochastics-9"></a><span class="kw">private</span> <span class="bu">Dimension</span> <span class="fu">getStochasticsDimension</span><span class="op">(</span><span class="dt">int</span> replicationCount<span class="op">,</span> <span class="dt">long</span> seed<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_example_15_stochastics-10"><a href="#lst-regions_plugin_example_15_stochastics-10"></a>    FunctionalDimension<span class="op">.</span><span class="fu">Builder</span> builder <span class="op">=</span> FunctionalDimension<span class="op">.</span><span class="fu">builder</span><span class="op">();</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_15_stochastics-11"><a href="#lst-regions_plugin_example_15_stochastics-11"></a></span>
<span id="lst-regions_plugin_example_15_stochastics-12"><a href="#lst-regions_plugin_example_15_stochastics-12"></a>    RandomGenerator randomGenerator <span class="op">=</span> RandomGeneratorProvider<span class="op">.</span><span class="fu">getRandomGenerator</span><span class="op">(</span>seed<span class="op">);</span></span>
<span id="lst-regions_plugin_example_15_stochastics-13"><a href="#lst-regions_plugin_example_15_stochastics-13"></a></span>
<span id="lst-regions_plugin_example_15_stochastics-14"><a href="#lst-regions_plugin_example_15_stochastics-14"></a>    <span class="bu">List</span><span class="op">&lt;</span><span class="bu">Long</span><span class="op">&gt;</span> seedValues <span class="op">=</span> <span class="kw">new</span> <span class="bu">ArrayList</span><span class="op">&lt;&gt;();</span></span>
<span id="lst-regions_plugin_example_15_stochastics-15"><a href="#lst-regions_plugin_example_15_stochastics-15"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> replicationCount<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_example_15_stochastics-16"><a href="#lst-regions_plugin_example_15_stochastics-16"></a>        seedValues<span class="op">.</span><span class="fu">add</span><span class="op">(</span>randomGenerator<span class="op">.</span><span class="fu">nextLong</span><span class="op">());</span></span>
<span id="lst-regions_plugin_example_15_stochastics-17"><a href="#lst-regions_plugin_example_15_stochastics-17"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_example_15_stochastics-18"><a href="#lst-regions_plugin_example_15_stochastics-18"></a></span>
<span id="lst-regions_plugin_example_15_stochastics-19"><a href="#lst-regions_plugin_example_15_stochastics-19"></a>    IntStream<span class="op">.</span><span class="fu">range</span><span class="op">(</span><span class="dv">0</span><span class="op">,</span> seedValues<span class="op">.</span><span class="fu">size</span><span class="op">()).</span><span class="fu">forEach</span><span class="op">((</span>i<span class="op">)</span> <span class="op">-&gt;</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_example_15_stochastics-20"><a href="#lst-regions_plugin_example_15_stochastics-20"></a>        builder<span class="op">.</span><span class="fu">addLevel</span><span class="op">((</span>context<span class="op">)</span> <span class="op">-&gt;</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_example_15_stochastics-21"><a href="#lst-regions_plugin_example_15_stochastics-21"></a>            StochasticsPluginData<span class="op">.</span><span class="fu">Builder</span> stochasticsPluginDataBuilder <span class="op">=</span> context</span>
<span id="lst-regions_plugin_example_15_stochastics-22"><a href="#lst-regions_plugin_example_15_stochastics-22"></a>                    <span class="op">.</span><span class="fu">getPluginDataBuilder</span><span class="op">(</span>StochasticsPluginData<span class="op">.</span><span class="fu">Builder</span><span class="op">.</span><span class="fu">class</span><span class="op">);</span></span>
<span id="lst-regions_plugin_example_15_stochastics-23"><a href="#lst-regions_plugin_example_15_stochastics-23"></a>            <span class="dt">long</span> seedValue <span class="op">=</span> seedValues<span class="op">.</span><span class="fu">get</span><span class="op">(</span>i<span class="op">);</span></span>
<span id="lst-regions_plugin_example_15_stochastics-24"><a href="#lst-regions_plugin_example_15_stochastics-24"></a>            WellState wellState <span class="op">=</span> WellState<span class="op">.</span><span class="fu">builder</span><span class="op">().</span><span class="fu">setSeed</span><span class="op">(</span>seedValue<span class="op">).</span><span class="fu">build</span><span class="op">();</span></span>
<span id="lst-regions_plugin_example_15_stochastics-25"><a href="#lst-regions_plugin_example_15_stochastics-25"></a>            stochasticsPluginDataBuilder<span class="op">.</span><span class="fu">setMainRNGState</span><span class="op">(</span>wellState<span class="op">);</span></span>
<span id="lst-regions_plugin_example_15_stochastics-26"><a href="#lst-regions_plugin_example_15_stochastics-26"></a></span>
<span id="lst-regions_plugin_example_15_stochastics-27"><a href="#lst-regions_plugin_example_15_stochastics-27"></a>            <span class="bu">ArrayList</span><span class="op">&lt;</span><span class="bu">String</span><span class="op">&gt;</span> result <span class="op">=</span> <span class="kw">new</span> <span class="bu">ArrayList</span><span class="op">&lt;&gt;();</span></span>
<span id="lst-regions_plugin_example_15_stochastics-28"><a href="#lst-regions_plugin_example_15_stochastics-28"></a>            result<span class="op">.</span><span class="fu">add</span><span class="op">(</span><span class="bu">Integer</span><span class="op">.</span><span class="fu">toString</span><span class="op">(</span>i<span class="op">));</span></span>
<span id="lst-regions_plugin_example_15_stochastics-29"><a href="#lst-regions_plugin_example_15_stochastics-29"></a>            result<span class="op">.</span><span class="fu">add</span><span class="op">(</span><span class="bu">Long</span><span class="op">.</span><span class="fu">toString</span><span class="op">(</span>seedValue<span class="op">)</span> <span class="op">+</span> <span class="st">"L"</span><span class="op">);</span></span>
<span id="lst-regions_plugin_example_15_stochastics-30"><a href="#lst-regions_plugin_example_15_stochastics-30"></a></span>
<span id="lst-regions_plugin_example_15_stochastics-31"><a href="#lst-regions_plugin_example_15_stochastics-31"></a>            <span class="cf">return</span> result<span class="op">;</span></span>
<span id="lst-regions_plugin_example_15_stochastics-32"><a href="#lst-regions_plugin_example_15_stochastics-32"></a>        <span class="op">});</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_15_stochastics-33"><a href="#lst-regions_plugin_example_15_stochastics-33"></a>    <span class="op">});</span></span>
<span id="lst-regions_plugin_example_15_stochastics-34"><a href="#lst-regions_plugin_example_15_stochastics-34"></a></span>
<span id="lst-regions_plugin_example_15_stochastics-35"><a href="#lst-regions_plugin_example_15_stochastics-35"></a>    builder<span class="op">.</span><span class="fu">addMetaDatum</span><span class="op">(</span><span class="st">"seed index"</span><span class="op">);</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_15_stochastics-36"><a href="#lst-regions_plugin_example_15_stochastics-36"></a>    builder<span class="op">.</span><span class="fu">addMetaDatum</span><span class="op">(</span><span class="st">"seed value"</span><span class="op">);</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_15_stochastics-37"><a href="#lst-regions_plugin_example_15_stochastics-37"></a></span>
<span id="lst-regions_plugin_example_15_stochastics-38"><a href="#lst-regions_plugin_example_15_stochastics-38"></a>    <span class="cf">return</span> builder<span class="op">.</span><span class="fu">build</span><span class="op">();</span></span>
<span id="lst-regions_plugin_example_15_stochastics-39"><a href="#lst-regions_plugin_example_15_stochastics-39"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Finally, we add the vaccine and model plugins. This will add the vaccine data manager as well as three previously mentioned actors that will be used to demonstrate the various capabilities of the regions plugin.</p>
<ul>
<li>PersonMover – used to move people between regions</li>
<li>RegionCreator – used to create new regions during the simulation run</li>
<li>Vaccinator – used to vaccinate people, reacting to changes in region properties</li>
</ul>
<p>The execute method finishes (<a href="#lst-regions_plugin_example_15_executing_experiment">Code Block&nbsp;<span>8.9</span></a>) by constructing and executing the experiment:</p>
<div class="cell">
<div id="lst-regions_plugin_example_15_executing_experiment" class="listing">
<p>Code Block&nbsp;8.9: The experiment is run with five scenarios, each using distinct random seed values.</p>
<div class="sourceCode cell-code" id="lst-regions_plugin_example_15_executing_experiment" data-lst-cap="The experiment is run with five scenarios, each using distinct random seed values."><pre class="sourceCode numberSource java number-lines code-with-copy"><code class="sourceCode java"><span id="lst-regions_plugin_example_15_executing_experiment-1"><a href="#lst-regions_plugin_example_15_executing_experiment-1"></a>Experiment<span class="op">.</span><span class="fu">builder</span><span class="op">()</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_15_executing_experiment-2"><a href="#lst-regions_plugin_example_15_executing_experiment-2"></a>        <span class="op">.</span><span class="fu">addPlugin</span><span class="op">(</span>modelPlugin<span class="op">)</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_15_executing_experiment-3"><a href="#lst-regions_plugin_example_15_executing_experiment-3"></a>        <span class="op">.</span><span class="fu">addPlugin</span><span class="op">(</span>regionsPlugin<span class="op">)</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_15_executing_experiment-4"><a href="#lst-regions_plugin_example_15_executing_experiment-4"></a>        <span class="op">.</span><span class="fu">addPlugin</span><span class="op">(</span>peoplePlugin<span class="op">)</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_15_executing_experiment-5"><a href="#lst-regions_plugin_example_15_executing_experiment-5"></a>        <span class="op">.</span><span class="fu">addPlugin</span><span class="op">(</span>stochasticsPlugin<span class="op">)</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_15_executing_experiment-6"><a href="#lst-regions_plugin_example_15_executing_experiment-6"></a>        <span class="op">.</span><span class="fu">addPlugin</span><span class="op">(</span>vaccinePlugin<span class="op">)</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_15_executing_experiment-7"><a href="#lst-regions_plugin_example_15_executing_experiment-7"></a>        <span class="op">.</span><span class="fu">addExperimentContextConsumer</span><span class="op">(</span>nioReportItemHandler<span class="op">)</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_15_executing_experiment-8"><a href="#lst-regions_plugin_example_15_executing_experiment-8"></a>        <span class="op">.</span><span class="fu">addDimension</span><span class="op">(</span>stochasticsDimension<span class="op">)</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_15_executing_experiment-9"><a href="#lst-regions_plugin_example_15_executing_experiment-9"></a>        <span class="op">.</span><span class="fu">build</span><span class="op">()</span><span class="co">//</span></span>
<span id="lst-regions_plugin_example_15_executing_experiment-10"><a href="#lst-regions_plugin_example_15_executing_experiment-10"></a>        <span class="op">.</span><span class="fu">execute</span><span class="op">();</span><span class="co">//</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="the-actors" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="the-actors"><span class="header-section-number">8.5</span> The actors</h2>
<p>We will finish this chapter by reviewing the three actors of the model plugin and then examine the three reports.</p>
<p>The PersonMover actor, in <a href="#lst-regions_plugin_person_mover_init">Code Block&nbsp;<span>8.10</span></a> and <a href="#lst-regions_plugin_person_mover_move_person">Code Block&nbsp;<span>8.11</span></a>, schedules 1000 random moves of a person from one region to another over the course of 100 days.</p>
<div class="cell">
<div id="lst-regions_plugin_person_mover_init" class="listing">
<p>Code Block&nbsp;8.10: The person mover actor plans for 1000 movements of people over time.</p>
<div class="sourceCode cell-code" id="lst-regions_plugin_person_mover_init" data-lst-cap="The person mover actor plans for 1000 movements of people over time."><pre class="sourceCode numberSource java number-lines code-with-copy"><code class="sourceCode java"><span id="lst-regions_plugin_person_mover_init-1"><a href="#lst-regions_plugin_person_mover_init-1"></a><span class="kw">public</span> <span class="dt">void</span> <span class="fu">init</span><span class="op">(</span>ActorContext actorContext<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_person_mover_init-2"><a href="#lst-regions_plugin_person_mover_init-2"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">1000</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_person_mover_init-3"><a href="#lst-regions_plugin_person_mover_init-3"></a>        <span class="dt">double</span> planTime <span class="op">=</span> <span class="op">((</span><span class="dt">double</span><span class="op">)</span> i<span class="op">)</span> <span class="op">*</span> <span class="fl">0.1</span><span class="op">;</span></span>
<span id="lst-regions_plugin_person_mover_init-4"><a href="#lst-regions_plugin_person_mover_init-4"></a>        actorContext<span class="op">.</span><span class="fu">addPlan</span><span class="op">(</span><span class="kw">this</span><span class="op">::</span>moveRandomPerson<span class="op">,</span> planTime<span class="op">);</span></span>
<span id="lst-regions_plugin_person_mover_init-5"><a href="#lst-regions_plugin_person_mover_init-5"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_person_mover_init-6"><a href="#lst-regions_plugin_person_mover_init-6"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Moving the person requires that we use the stochastics plugin and the people plugin to select a random person. We next use the regions plugin to first select a random new region for the person and then move the person to that region.</p>
<div class="cell">
<div id="lst-regions_plugin_person_mover_move_person" class="listing">
<p>Code Block&nbsp;8.11: The person mover actor attempts to move a randomly selected person from their current region to a new region.</p>
<div class="sourceCode cell-code" id="lst-regions_plugin_person_mover_move_person" data-lst-cap="The person mover actor attempts to move a randomly selected person from their current region to a new region."><pre class="sourceCode numberSource java number-lines code-with-copy"><code class="sourceCode java"><span id="lst-regions_plugin_person_mover_move_person-1"><a href="#lst-regions_plugin_person_mover_move_person-1"></a><span class="kw">private</span> <span class="dt">void</span> <span class="fu">moveRandomPerson</span><span class="op">(</span>ActorContext actorContext<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_person_mover_move_person-2"><a href="#lst-regions_plugin_person_mover_move_person-2"></a>    StochasticsDataManager stochasticsDataManager <span class="op">=</span> actorContext<span class="op">.</span><span class="fu">getDataManager</span><span class="op">(</span>StochasticsDataManager<span class="op">.</span><span class="fu">class</span><span class="op">);</span></span>
<span id="lst-regions_plugin_person_mover_move_person-3"><a href="#lst-regions_plugin_person_mover_move_person-3"></a>    RandomGenerator randomGenerator <span class="op">=</span> stochasticsDataManager<span class="op">.</span><span class="fu">getRandomGenerator</span><span class="op">();</span></span>
<span id="lst-regions_plugin_person_mover_move_person-4"><a href="#lst-regions_plugin_person_mover_move_person-4"></a>    PeopleDataManager peopleDataManager <span class="op">=</span> actorContext<span class="op">.</span><span class="fu">getDataManager</span><span class="op">(</span>PeopleDataManager<span class="op">.</span><span class="fu">class</span><span class="op">);</span></span>
<span id="lst-regions_plugin_person_mover_move_person-5"><a href="#lst-regions_plugin_person_mover_move_person-5"></a>    RegionsDataManager regionsDataManager <span class="op">=</span> actorContext<span class="op">.</span><span class="fu">getDataManager</span><span class="op">(</span>RegionsDataManager<span class="op">.</span><span class="fu">class</span><span class="op">);</span></span>
<span id="lst-regions_plugin_person_mover_move_person-6"><a href="#lst-regions_plugin_person_mover_move_person-6"></a></span>
<span id="lst-regions_plugin_person_mover_move_person-7"><a href="#lst-regions_plugin_person_mover_move_person-7"></a>    <span class="co">// pick a random person</span></span>
<span id="lst-regions_plugin_person_mover_move_person-8"><a href="#lst-regions_plugin_person_mover_move_person-8"></a>    <span class="bu">List</span><span class="op">&lt;</span>PersonId<span class="op">&gt;</span> people <span class="op">=</span> peopleDataManager<span class="op">.</span><span class="fu">getPeople</span><span class="op">();</span></span>
<span id="lst-regions_plugin_person_mover_move_person-9"><a href="#lst-regions_plugin_person_mover_move_person-9"></a>    <span class="cf">if</span> <span class="op">(</span>people<span class="op">.</span><span class="fu">isEmpty</span><span class="op">())</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_person_mover_move_person-10"><a href="#lst-regions_plugin_person_mover_move_person-10"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="lst-regions_plugin_person_mover_move_person-11"><a href="#lst-regions_plugin_person_mover_move_person-11"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_person_mover_move_person-12"><a href="#lst-regions_plugin_person_mover_move_person-12"></a>    PersonId personId <span class="op">=</span> people<span class="op">.</span><span class="fu">get</span><span class="op">(</span>randomGenerator<span class="op">.</span><span class="fu">nextInt</span><span class="op">(</span>people<span class="op">.</span><span class="fu">size</span><span class="op">()));</span></span>
<span id="lst-regions_plugin_person_mover_move_person-13"><a href="#lst-regions_plugin_person_mover_move_person-13"></a></span>
<span id="lst-regions_plugin_person_mover_move_person-14"><a href="#lst-regions_plugin_person_mover_move_person-14"></a>    <span class="co">// pick a new random new region for that person</span></span>
<span id="lst-regions_plugin_person_mover_move_person-15"><a href="#lst-regions_plugin_person_mover_move_person-15"></a>    <span class="bu">List</span><span class="op">&lt;</span>RegionId<span class="op">&gt;</span> regionIds <span class="op">=</span> <span class="kw">new</span> <span class="bu">ArrayList</span><span class="op">&lt;&gt;(</span>regionsDataManager<span class="op">.</span><span class="fu">getRegionIds</span><span class="op">());</span></span>
<span id="lst-regions_plugin_person_mover_move_person-16"><a href="#lst-regions_plugin_person_mover_move_person-16"></a>    RegionId personRegion <span class="op">=</span> regionsDataManager<span class="op">.</span><span class="fu">getPersonRegion</span><span class="op">(</span>personId<span class="op">);</span></span>
<span id="lst-regions_plugin_person_mover_move_person-17"><a href="#lst-regions_plugin_person_mover_move_person-17"></a>    regionIds<span class="op">.</span><span class="fu">remove</span><span class="op">(</span>personRegion<span class="op">);</span></span>
<span id="lst-regions_plugin_person_mover_move_person-18"><a href="#lst-regions_plugin_person_mover_move_person-18"></a>    <span class="cf">if</span> <span class="op">(</span>regionIds<span class="op">.</span><span class="fu">isEmpty</span><span class="op">())</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_person_mover_move_person-19"><a href="#lst-regions_plugin_person_mover_move_person-19"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="lst-regions_plugin_person_mover_move_person-20"><a href="#lst-regions_plugin_person_mover_move_person-20"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_person_mover_move_person-21"><a href="#lst-regions_plugin_person_mover_move_person-21"></a>    RegionId newPersonRegion <span class="op">=</span> regionIds<span class="op">.</span><span class="fu">get</span><span class="op">(</span>randomGenerator<span class="op">.</span><span class="fu">nextInt</span><span class="op">(</span>regionIds<span class="op">.</span><span class="fu">size</span><span class="op">()));</span></span>
<span id="lst-regions_plugin_person_mover_move_person-22"><a href="#lst-regions_plugin_person_mover_move_person-22"></a></span>
<span id="lst-regions_plugin_person_mover_move_person-23"><a href="#lst-regions_plugin_person_mover_move_person-23"></a>    <span class="co">// assign the region to the person</span></span>
<span id="lst-regions_plugin_person_mover_move_person-24"><a href="#lst-regions_plugin_person_mover_move_person-24"></a>    regionsDataManager<span class="op">.</span><span class="fu">setPersonRegion</span><span class="op">(</span>personId<span class="op">,</span> newPersonRegion<span class="op">);</span></span>
<span id="lst-regions_plugin_person_mover_move_person-25"><a href="#lst-regions_plugin_person_mover_move_person-25"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>The RegionCreator actor, in <a href="#lst-regions_plugin_region_creator_init">Code Block&nbsp;<span>8.12</span></a> and <a href="#lst-regions_plugin_region_creator_add_region">Code Block&nbsp;<span>8.13</span></a>, follows a similar pattern, scheduling the creation of five new regions over 101 days.</p>
<div class="cell">
<div id="lst-regions_plugin_region_creator_init" class="listing">
<p>Code Block&nbsp;8.12: The region creator actor plans the addition of five new regions.</p>
<div class="sourceCode cell-code" id="lst-regions_plugin_region_creator_init" data-lst-cap="The region creator actor plans the addition of five new regions."><pre class="sourceCode numberSource java number-lines code-with-copy"><code class="sourceCode java"><span id="lst-regions_plugin_region_creator_init-1"><a href="#lst-regions_plugin_region_creator_init-1"></a><span class="kw">public</span> <span class="dt">void</span> <span class="fu">init</span><span class="op">(</span>ActorContext actorContext<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_region_creator_init-2"><a href="#lst-regions_plugin_region_creator_init-2"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">5</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_region_creator_init-3"><a href="#lst-regions_plugin_region_creator_init-3"></a>        <span class="dt">double</span> planTime <span class="op">=</span> <span class="dv">20</span> <span class="op">*</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="lst-regions_plugin_region_creator_init-4"><a href="#lst-regions_plugin_region_creator_init-4"></a>        actorContext<span class="op">.</span><span class="fu">addPlan</span><span class="op">(</span><span class="kw">this</span><span class="op">::</span>addRegion<span class="op">,</span> planTime<span class="op">);</span></span>
<span id="lst-regions_plugin_region_creator_init-5"><a href="#lst-regions_plugin_region_creator_init-5"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_region_creator_init-6"><a href="#lst-regions_plugin_region_creator_init-6"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>When adding a region, we have to be aware that the region will have LAT and LON properties and that these properties were not defined with default values. Thus we must supply values for the region’s latitude and longitude as part of the RegionConstructionData object that is passed to the regions data manager. We will similarly assign a new random Boolean value for the VACCINE_PRIORITY property. The VACCINE_PRIORITY is a dynamically added property that is introduced later. Note that we first check for the existence of the property and only then set a value since setting such a value before the property is defined will result in a runtime exception.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Such considerations are unusual since properties are usually defined in the plugin initialization data or added very early in the simulation before any actors have initialized. We do so here for the purposes of demonstrating dynamic property definitions.</p>
</div>
</div>
<div class="cell">
<div id="lst-regions_plugin_region_creator_add_region" class="listing">
<p>Code Block&nbsp;8.13: When the region creator actor adds a new region, it assigns a random lat-lon corrdinate and possibly assigns a vaccine priority status to the region.</p>
<div class="sourceCode cell-code" id="lst-regions_plugin_region_creator_add_region" data-lst-cap="When the region creator actor adds a new region, it assigns a random lat-lon corrdinate and possibly assigns a vaccine priority status to the region."><pre class="sourceCode numberSource java number-lines code-with-copy"><code class="sourceCode java"><span id="lst-regions_plugin_region_creator_add_region-1"><a href="#lst-regions_plugin_region_creator_add_region-1"></a><span class="kw">private</span> <span class="dt">void</span> <span class="fu">addRegion</span><span class="op">(</span>ActorContext actorContext<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_region_creator_add_region-2"><a href="#lst-regions_plugin_region_creator_add_region-2"></a>    RegionsDataManager regionsDataManager <span class="op">=</span> actorContext<span class="op">.</span><span class="fu">getDataManager</span><span class="op">(</span>RegionsDataManager<span class="op">.</span><span class="fu">class</span><span class="op">);</span></span>
<span id="lst-regions_plugin_region_creator_add_region-3"><a href="#lst-regions_plugin_region_creator_add_region-3"></a>    StochasticsDataManager stochasticsDataManager <span class="op">=</span> actorContext<span class="op">.</span><span class="fu">getDataManager</span><span class="op">(</span>StochasticsDataManager<span class="op">.</span><span class="fu">class</span><span class="op">);</span></span>
<span id="lst-regions_plugin_region_creator_add_region-4"><a href="#lst-regions_plugin_region_creator_add_region-4"></a>    RandomGenerator randomGenerator <span class="op">=</span> stochasticsDataManager<span class="op">.</span><span class="fu">getRandomGenerator</span><span class="op">();</span></span>
<span id="lst-regions_plugin_region_creator_add_region-5"><a href="#lst-regions_plugin_region_creator_add_region-5"></a></span>
<span id="lst-regions_plugin_region_creator_add_region-6"><a href="#lst-regions_plugin_region_creator_add_region-6"></a>    <span class="bu">Set</span><span class="op">&lt;</span><span class="bu">Region</span><span class="op">&gt;</span> regions <span class="op">=</span> regionsDataManager<span class="op">.</span><span class="fu">getRegionIds</span><span class="op">();</span></span>
<span id="lst-regions_plugin_region_creator_add_region-7"><a href="#lst-regions_plugin_region_creator_add_region-7"></a>    <span class="dt">int</span> maxRegionValue <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="lst-regions_plugin_region_creator_add_region-8"><a href="#lst-regions_plugin_region_creator_add_region-8"></a>    <span class="cf">for</span> <span class="op">(</span><span class="bu">Region</span> region <span class="op">:</span> regions<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_region_creator_add_region-9"><a href="#lst-regions_plugin_region_creator_add_region-9"></a>        <span class="dt">int</span> value <span class="op">=</span> region<span class="op">.</span><span class="fu">getValue</span><span class="op">();</span></span>
<span id="lst-regions_plugin_region_creator_add_region-10"><a href="#lst-regions_plugin_region_creator_add_region-10"></a>        maxRegionValue <span class="op">=</span> FastMath<span class="op">.</span><span class="fu">max</span><span class="op">(</span>value<span class="op">,</span> maxRegionValue<span class="op">);</span></span>
<span id="lst-regions_plugin_region_creator_add_region-11"><a href="#lst-regions_plugin_region_creator_add_region-11"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_region_creator_add_region-12"><a href="#lst-regions_plugin_region_creator_add_region-12"></a>    <span class="bu">Region</span> newRegion <span class="op">=</span> <span class="kw">new</span> <span class="bu">Region</span><span class="op">(</span>maxRegionValue <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="lst-regions_plugin_region_creator_add_region-13"><a href="#lst-regions_plugin_region_creator_add_region-13"></a>    Builder regionBuilder <span class="op">=</span> RegionConstructionData<span class="op">.</span><span class="fu">builder</span><span class="op">().</span><span class="fu">setRegionId</span><span class="op">(</span>newRegion<span class="op">);</span></span>
<span id="lst-regions_plugin_region_creator_add_region-14"><a href="#lst-regions_plugin_region_creator_add_region-14"></a>    regionBuilder<span class="op">.</span><span class="fu">setRegionPropertyValue</span><span class="op">(</span>RegionProperty<span class="op">.</span><span class="fu">LAT</span><span class="op">,</span> <span class="dv">35</span> <span class="op">+</span> randomGenerator<span class="op">.</span><span class="fu">nextDouble</span><span class="op">());</span></span>
<span id="lst-regions_plugin_region_creator_add_region-15"><a href="#lst-regions_plugin_region_creator_add_region-15"></a>    regionBuilder<span class="op">.</span><span class="fu">setRegionPropertyValue</span><span class="op">(</span>RegionProperty<span class="op">.</span><span class="fu">LON</span><span class="op">,</span> <span class="dv">128</span> <span class="op">+</span> randomGenerator<span class="op">.</span><span class="fu">nextDouble</span><span class="op">());</span></span>
<span id="lst-regions_plugin_region_creator_add_region-16"><a href="#lst-regions_plugin_region_creator_add_region-16"></a></span>
<span id="lst-regions_plugin_region_creator_add_region-17"><a href="#lst-regions_plugin_region_creator_add_region-17"></a>    <span class="cf">if</span> <span class="op">(</span>regionsDataManager<span class="op">.</span><span class="fu">regionPropertyIdExists</span><span class="op">(</span>RegionProperty<span class="op">.</span><span class="fu">VACCINE_PRIORITY</span><span class="op">))</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_region_creator_add_region-18"><a href="#lst-regions_plugin_region_creator_add_region-18"></a>        regionBuilder<span class="op">.</span><span class="fu">setRegionPropertyValue</span><span class="op">(</span>RegionProperty<span class="op">.</span><span class="fu">VACCINE_PRIORITY</span><span class="op">,</span> randomGenerator<span class="op">.</span><span class="fu">nextBoolean</span><span class="op">());</span></span>
<span id="lst-regions_plugin_region_creator_add_region-19"><a href="#lst-regions_plugin_region_creator_add_region-19"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_region_creator_add_region-20"><a href="#lst-regions_plugin_region_creator_add_region-20"></a>    RegionConstructionData regionConstructionData <span class="op">=</span> regionBuilder<span class="op">.</span><span class="fu">build</span><span class="op">();</span></span>
<span id="lst-regions_plugin_region_creator_add_region-21"><a href="#lst-regions_plugin_region_creator_add_region-21"></a>    regionsDataManager<span class="op">.</span><span class="fu">addRegion</span><span class="op">(</span>regionConstructionData<span class="op">);</span></span>
<span id="lst-regions_plugin_region_creator_add_region-22"><a href="#lst-regions_plugin_region_creator_add_region-22"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>The Vaccinator actor is somewhat more complicated than the other actors. It initializes (<a href="#lst-regions_plugin_vaccinator_init">Code Block&nbsp;<span>8.14</span></a>) by storing references to various data managers for convenience and then plans 5000 vaccinations spread over 100 days. It also plans to add the VACCINE_PRIORITY property on day 50.</p>
<div class="cell">
<div id="lst-regions_plugin_vaccinator_init" class="listing">
<p>Code Block&nbsp;8.14: The vaccinator initializes by planning the vaccination of 5000 people carried out over approximately 50 days.</p>
<div class="sourceCode cell-code" id="lst-regions_plugin_vaccinator_init" data-lst-cap="The vaccinator initializes by planning the vaccination of 5000 people carried out over approximately 50 days."><pre class="sourceCode numberSource java number-lines code-with-copy"><code class="sourceCode java"><span id="lst-regions_plugin_vaccinator_init-1"><a href="#lst-regions_plugin_vaccinator_init-1"></a><span class="kw">public</span> <span class="dt">void</span> <span class="fu">init</span><span class="op">(</span>ActorContext actorContext<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_vaccinator_init-2"><a href="#lst-regions_plugin_vaccinator_init-2"></a>    StochasticsDataManager stochasticsDataManager <span class="op">=</span> actorContext<span class="op">.</span><span class="fu">getDataManager</span><span class="op">(</span>StochasticsDataManager<span class="op">.</span><span class="fu">class</span><span class="op">);</span></span>
<span id="lst-regions_plugin_vaccinator_init-3"><a href="#lst-regions_plugin_vaccinator_init-3"></a>    randomGenerator <span class="op">=</span> stochasticsDataManager<span class="op">.</span><span class="fu">getRandomGenerator</span><span class="op">();</span></span>
<span id="lst-regions_plugin_vaccinator_init-4"><a href="#lst-regions_plugin_vaccinator_init-4"></a>    regionsDataManager <span class="op">=</span> actorContext<span class="op">.</span><span class="fu">getDataManager</span><span class="op">(</span>RegionsDataManager<span class="op">.</span><span class="fu">class</span><span class="op">);</span></span>
<span id="lst-regions_plugin_vaccinator_init-5"><a href="#lst-regions_plugin_vaccinator_init-5"></a>    vaccinationDataManager <span class="op">=</span> actorContext<span class="op">.</span><span class="fu">getDataManager</span><span class="op">(</span>VaccinationDataManager<span class="op">.</span><span class="fu">class</span><span class="op">);</span></span>
<span id="lst-regions_plugin_vaccinator_init-6"><a href="#lst-regions_plugin_vaccinator_init-6"></a></span>
<span id="lst-regions_plugin_vaccinator_init-7"><a href="#lst-regions_plugin_vaccinator_init-7"></a>    <span class="dt">double</span> planTime <span class="op">=</span> randomGenerator<span class="op">.</span><span class="fu">nextDouble</span><span class="op">();</span></span>
<span id="lst-regions_plugin_vaccinator_init-8"><a href="#lst-regions_plugin_vaccinator_init-8"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">5000</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_vaccinator_init-9"><a href="#lst-regions_plugin_vaccinator_init-9"></a>        actorContext<span class="op">.</span><span class="fu">addPlan</span><span class="op">(</span><span class="kw">this</span><span class="op">::</span>vaccinateRandomPerson<span class="op">,</span> planTime<span class="op">);</span></span>
<span id="lst-regions_plugin_vaccinator_init-10"><a href="#lst-regions_plugin_vaccinator_init-10"></a>        planTime <span class="op">+=</span> randomGenerator<span class="op">.</span><span class="fu">nextDouble</span><span class="op">()</span> <span class="op">*</span> <span class="fl">0.02</span><span class="op">;</span></span>
<span id="lst-regions_plugin_vaccinator_init-11"><a href="#lst-regions_plugin_vaccinator_init-11"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_vaccinator_init-12"><a href="#lst-regions_plugin_vaccinator_init-12"></a></span>
<span id="lst-regions_plugin_vaccinator_init-13"><a href="#lst-regions_plugin_vaccinator_init-13"></a>    actorContext<span class="op">.</span><span class="fu">addPlan</span><span class="op">(</span><span class="kw">this</span><span class="op">::</span>addVaccinePriorityPropertyToRegions<span class="op">,</span> <span class="dv">50</span><span class="op">);</span></span>
<span id="lst-regions_plugin_vaccinator_init-14"><a href="#lst-regions_plugin_vaccinator_init-14"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Let’s first look at the addition of the new region property on day 50 in <a href="#lst-regions_plugin_vaccinator_priority_property">Code Block&nbsp;<span>8.15</span></a>. The new property is a Boolean value defaulted to false and indicates whether people should be chosen from regions randomly or by preferring people with the fewest vaccinations. Since the property has a default value, we do not have to set values for each region in the RegionPropertyDefinitionInitialization object that is passed to the regions data manager when creating the region. We do so anyway to demonstrate such value assignments. Once the new property is in place, the Vaccinator schedules the switching of the value for random regions once per day for the next 50 days.</p>
<div class="cell">
<div id="lst-regions_plugin_vaccinator_priority_property" class="listing">
<p>Code Block&nbsp;8.15: On day 50, the vaccinator defines the Boolean VACCINE PRIORITY property and assigns randomized values to the existing regions. It then plans for updates to 50 regional vaccine priority property values over 50 days.</p>
<div class="sourceCode cell-code" id="lst-regions_plugin_vaccinator_priority_property" data-lst-cap="On day 50, the vaccinator defines the Boolean VACCINE PRIORITY property and assigns randomized values to the existing regions. It then plans for updates to 50 regional vaccine priority property values over 50 days."><pre class="sourceCode numberSource java number-lines code-with-copy"><code class="sourceCode java"><span id="lst-regions_plugin_vaccinator_priority_property-1"><a href="#lst-regions_plugin_vaccinator_priority_property-1"></a><span class="kw">private</span> <span class="dt">void</span> <span class="fu">addVaccinePriorityPropertyToRegions</span><span class="op">(</span>ActorContext actorContext<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_vaccinator_priority_property-2"><a href="#lst-regions_plugin_vaccinator_priority_property-2"></a></span>
<span id="lst-regions_plugin_vaccinator_priority_property-3"><a href="#lst-regions_plugin_vaccinator_priority_property-3"></a>    PropertyDefinition propertyDefinition <span class="op">=</span> <span class="co">//</span></span>
<span id="lst-regions_plugin_vaccinator_priority_property-4"><a href="#lst-regions_plugin_vaccinator_priority_property-4"></a>            PropertyDefinition<span class="op">.</span><span class="fu">builder</span><span class="op">()</span><span class="co">//</span></span>
<span id="lst-regions_plugin_vaccinator_priority_property-5"><a href="#lst-regions_plugin_vaccinator_priority_property-5"></a>                    <span class="op">.</span><span class="fu">setType</span><span class="op">(</span><span class="bu">Boolean</span><span class="op">.</span><span class="fu">class</span><span class="op">)</span><span class="co">//</span></span>
<span id="lst-regions_plugin_vaccinator_priority_property-6"><a href="#lst-regions_plugin_vaccinator_priority_property-6"></a>                    <span class="op">.</span><span class="fu">setDefaultValue</span><span class="op">(</span><span class="kw">false</span><span class="op">)</span><span class="co">//</span></span>
<span id="lst-regions_plugin_vaccinator_priority_property-7"><a href="#lst-regions_plugin_vaccinator_priority_property-7"></a>                    <span class="op">.</span><span class="fu">build</span><span class="op">();</span></span>
<span id="lst-regions_plugin_vaccinator_priority_property-8"><a href="#lst-regions_plugin_vaccinator_priority_property-8"></a></span>
<span id="lst-regions_plugin_vaccinator_priority_property-9"><a href="#lst-regions_plugin_vaccinator_priority_property-9"></a>    RegionPropertyDefinitionInitialization<span class="op">.</span><span class="fu">Builder</span> defBuilder <span class="op">=</span> RegionPropertyDefinitionInitialization<span class="op">.</span><span class="fu">builder</span><span class="op">()</span><span class="co">//</span></span>
<span id="lst-regions_plugin_vaccinator_priority_property-10"><a href="#lst-regions_plugin_vaccinator_priority_property-10"></a>            <span class="op">.</span><span class="fu">setPropertyDefinition</span><span class="op">(</span>propertyDefinition<span class="op">)</span><span class="co">//</span></span>
<span id="lst-regions_plugin_vaccinator_priority_property-11"><a href="#lst-regions_plugin_vaccinator_priority_property-11"></a>            <span class="op">.</span><span class="fu">setRegionPropertyId</span><span class="op">(</span>RegionProperty<span class="op">.</span><span class="fu">VACCINE_PRIORITY</span><span class="op">);</span></span>
<span id="lst-regions_plugin_vaccinator_priority_property-12"><a href="#lst-regions_plugin_vaccinator_priority_property-12"></a></span>
<span id="lst-regions_plugin_vaccinator_priority_property-13"><a href="#lst-regions_plugin_vaccinator_priority_property-13"></a>    <span class="cf">for</span> <span class="op">(</span>RegionId regionId <span class="op">:</span> regionsDataManager<span class="op">.</span><span class="fu">getRegionIds</span><span class="op">())</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_vaccinator_priority_property-14"><a href="#lst-regions_plugin_vaccinator_priority_property-14"></a>        defBuilder<span class="op">.</span><span class="fu">addPropertyValue</span><span class="op">(</span>regionId<span class="op">,</span> randomGenerator<span class="op">.</span><span class="fu">nextBoolean</span><span class="op">());</span></span>
<span id="lst-regions_plugin_vaccinator_priority_property-15"><a href="#lst-regions_plugin_vaccinator_priority_property-15"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_vaccinator_priority_property-16"><a href="#lst-regions_plugin_vaccinator_priority_property-16"></a></span>
<span id="lst-regions_plugin_vaccinator_priority_property-17"><a href="#lst-regions_plugin_vaccinator_priority_property-17"></a>    RegionPropertyDefinitionInitialization regionPropertyDefinitionInitialization <span class="op">=</span> defBuilder<span class="op">.</span><span class="fu">build</span><span class="op">();</span></span>
<span id="lst-regions_plugin_vaccinator_priority_property-18"><a href="#lst-regions_plugin_vaccinator_priority_property-18"></a>    regionsDataManager<span class="op">.</span><span class="fu">defineRegionProperty</span><span class="op">(</span>regionPropertyDefinitionInitialization<span class="op">);</span></span>
<span id="lst-regions_plugin_vaccinator_priority_property-19"><a href="#lst-regions_plugin_vaccinator_priority_property-19"></a></span>
<span id="lst-regions_plugin_vaccinator_priority_property-20"><a href="#lst-regions_plugin_vaccinator_priority_property-20"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">50</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_vaccinator_priority_property-21"><a href="#lst-regions_plugin_vaccinator_priority_property-21"></a>        <span class="dt">double</span> planTime <span class="op">=</span> actorContext<span class="op">.</span><span class="fu">getTime</span><span class="op">()</span> <span class="op">+</span> i<span class="op">;</span></span>
<span id="lst-regions_plugin_vaccinator_priority_property-22"><a href="#lst-regions_plugin_vaccinator_priority_property-22"></a>        actorContext<span class="op">.</span><span class="fu">addPlan</span><span class="op">(</span><span class="kw">this</span><span class="op">::</span>alterVaccinePriorityPropertyOnRandomRegion<span class="op">,</span> planTime<span class="op">);</span></span>
<span id="lst-regions_plugin_vaccinator_priority_property-23"><a href="#lst-regions_plugin_vaccinator_priority_property-23"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_vaccinator_priority_property-24"><a href="#lst-regions_plugin_vaccinator_priority_property-24"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>In <a href="#lst-regions_plugin_vaccinator_alter_priority_property">Code Block&nbsp;<span>8.16</span></a> the Vaccinator performs this value switching:</p>
<div class="cell">
<div id="lst-regions_plugin_vaccinator_alter_priority_property" class="listing">
<p>Code Block&nbsp;8.16: Toggling the vaccine priority for a randomly selected region.</p>
<div class="sourceCode cell-code" id="lst-regions_plugin_vaccinator_alter_priority_property" data-lst-cap="Toggling the vaccine priority for a randomly selected region."><pre class="sourceCode numberSource java number-lines code-with-copy"><code class="sourceCode java"><span id="lst-regions_plugin_vaccinator_alter_priority_property-1"><a href="#lst-regions_plugin_vaccinator_alter_priority_property-1"></a><span class="kw">private</span> <span class="dt">void</span> <span class="fu">alterVaccinePriorityPropertyOnRandomRegion</span><span class="op">(</span>ActorContext actorContext<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_vaccinator_alter_priority_property-2"><a href="#lst-regions_plugin_vaccinator_alter_priority_property-2"></a>    <span class="bu">List</span><span class="op">&lt;</span>RegionId<span class="op">&gt;</span> regionids <span class="op">=</span> <span class="kw">new</span> <span class="bu">ArrayList</span><span class="op">&lt;&gt;(</span>regionsDataManager<span class="op">.</span><span class="fu">getRegionIds</span><span class="op">());</span></span>
<span id="lst-regions_plugin_vaccinator_alter_priority_property-3"><a href="#lst-regions_plugin_vaccinator_alter_priority_property-3"></a>    <span class="cf">if</span> <span class="op">(</span>regionids<span class="op">.</span><span class="fu">isEmpty</span><span class="op">())</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_vaccinator_alter_priority_property-4"><a href="#lst-regions_plugin_vaccinator_alter_priority_property-4"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="lst-regions_plugin_vaccinator_alter_priority_property-5"><a href="#lst-regions_plugin_vaccinator_alter_priority_property-5"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_vaccinator_alter_priority_property-6"><a href="#lst-regions_plugin_vaccinator_alter_priority_property-6"></a>    RegionId regionId <span class="op">=</span> regionids<span class="op">.</span><span class="fu">get</span><span class="op">(</span>randomGenerator<span class="op">.</span><span class="fu">nextInt</span><span class="op">(</span>regionids<span class="op">.</span><span class="fu">size</span><span class="op">()));</span></span>
<span id="lst-regions_plugin_vaccinator_alter_priority_property-7"><a href="#lst-regions_plugin_vaccinator_alter_priority_property-7"></a>    <span class="bu">Boolean</span> vaccinePriority <span class="op">=</span> regionsDataManager<span class="op">.</span><span class="fu">getRegionPropertyValue</span><span class="op">(</span>regionId<span class="op">,</span> RegionProperty<span class="op">.</span><span class="fu">VACCINE_PRIORITY</span><span class="op">);</span></span>
<span id="lst-regions_plugin_vaccinator_alter_priority_property-8"><a href="#lst-regions_plugin_vaccinator_alter_priority_property-8"></a>    regionsDataManager<span class="op">.</span><span class="fu">setRegionPropertyValue</span><span class="op">(</span>regionId<span class="op">,</span> RegionProperty<span class="op">.</span><span class="fu">VACCINE_PRIORITY</span><span class="op">,</span> <span class="op">!</span>vaccinePriority<span class="op">);</span></span>
<span id="lst-regions_plugin_vaccinator_alter_priority_property-9"><a href="#lst-regions_plugin_vaccinator_alter_priority_property-9"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>The Vaccinator vaccinates people at random (<a href="#lst-regions_plugin_vaccinator_vaccinate_random_person">Code Block&nbsp;<span>8.17</span></a>) by first selecting a random region and then selecting a random person in that region. The selection of the person is subject to the presence of the VACCINE_PRIORITY property and whether the value of the property is true for the selected region. If the priority selection is being used, then a first pass through the people in the region establishes the lowest number of vaccines received by any person. A second pass through the same people now selects only those having this number of vaccinations. Finally, a person is selected at random from the eligible people.</p>
<div class="cell">
<div id="lst-regions_plugin_vaccinator_vaccinate_random_person" class="listing">
<p>Code Block&nbsp;8.17: The vaccinator selects a person at random from the population to vaccinate. If the region is using the VACCINE_PRIORITY policy, then those with the least number of vaccinations have preference.</p>
<div class="sourceCode cell-code" id="lst-regions_plugin_vaccinator_vaccinate_random_person" data-lst-cap="The vaccinator selects a person at random from the population to vaccinate. If the region is using the VACCINE_PRIORITY policy, then those with the least number of vaccinations have preference."><pre class="sourceCode numberSource java number-lines code-with-copy"><code class="sourceCode java"><span id="lst-regions_plugin_vaccinator_vaccinate_random_person-1"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-1"></a><span class="kw">private</span> <span class="dt">void</span> <span class="fu">vaccinateRandomPerson</span><span class="op">(</span>ActorContext actorContext<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-2"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-2"></a></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-3"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-3"></a>    <span class="bu">List</span><span class="op">&lt;</span>RegionId<span class="op">&gt;</span> regionIds <span class="op">=</span> <span class="kw">new</span> <span class="bu">ArrayList</span><span class="op">&lt;&gt;(</span>regionsDataManager<span class="op">.</span><span class="fu">getRegionIds</span><span class="op">());</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-4"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-4"></a>    <span class="cf">if</span> <span class="op">(</span>regionIds<span class="op">.</span><span class="fu">isEmpty</span><span class="op">())</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-5"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-5"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-6"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-6"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-7"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-7"></a>    RegionId regionId <span class="op">=</span> regionIds<span class="op">.</span><span class="fu">get</span><span class="op">(</span>randomGenerator<span class="op">.</span><span class="fu">nextInt</span><span class="op">(</span>regionIds<span class="op">.</span><span class="fu">size</span><span class="op">()));</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-8"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-8"></a>    <span class="bu">List</span><span class="op">&lt;</span>PersonId<span class="op">&gt;</span> peopleInRegion <span class="op">=</span> regionsDataManager<span class="op">.</span><span class="fu">getPeopleInRegion</span><span class="op">(</span>regionId<span class="op">);</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-9"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-9"></a></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-10"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-10"></a>    <span class="bu">Boolean</span> prioritizePeople <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-11"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-11"></a>    <span class="dt">boolean</span> vaccinePriorityPropertyExists <span class="op">=</span> regionsDataManager</span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-12"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-12"></a>            <span class="op">.</span><span class="fu">regionPropertyIdExists</span><span class="op">(</span>RegionProperty<span class="op">.</span><span class="fu">VACCINE_PRIORITY</span><span class="op">);</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-13"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-13"></a>    <span class="cf">if</span> <span class="op">(</span>vaccinePriorityPropertyExists<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-14"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-14"></a>        prioritizePeople <span class="op">=</span> regionsDataManager<span class="op">.</span><span class="fu">getRegionPropertyValue</span><span class="op">(</span>regionId<span class="op">,</span> RegionProperty<span class="op">.</span><span class="fu">VACCINE_PRIORITY</span><span class="op">);</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-15"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-15"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-16"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-16"></a></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-17"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-17"></a>    PersonId selectedPersonId <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-18"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-18"></a>    <span class="cf">if</span> <span class="op">(</span>prioritizePeople<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-19"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-19"></a>        <span class="dt">int</span> minVaccinationCount <span class="op">=</span> <span class="bu">Integer</span><span class="op">.</span><span class="fu">MAX_VALUE</span><span class="op">;</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-20"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-20"></a>        <span class="cf">for</span> <span class="op">(</span>PersonId personId <span class="op">:</span> peopleInRegion<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-21"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-21"></a>            <span class="dt">int</span> personVaccinationCount <span class="op">=</span> vaccinationDataManager<span class="op">.</span><span class="fu">getPersonVaccinationCount</span><span class="op">(</span>personId<span class="op">);</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-22"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-22"></a>            <span class="cf">if</span> <span class="op">(</span>personVaccinationCount <span class="op">&lt;</span> minVaccinationCount<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-23"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-23"></a>                minVaccinationCount <span class="op">=</span> personVaccinationCount<span class="op">;</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-24"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-24"></a>            <span class="op">}</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-25"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-25"></a>        <span class="op">}</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-26"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-26"></a>        <span class="bu">List</span><span class="op">&lt;</span>PersonId<span class="op">&gt;</span> eligiblePeople <span class="op">=</span> <span class="kw">new</span> <span class="bu">ArrayList</span><span class="op">&lt;&gt;();</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-27"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-27"></a>        <span class="cf">for</span> <span class="op">(</span>PersonId personId <span class="op">:</span> peopleInRegion<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-28"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-28"></a>            <span class="dt">int</span> personVaccinationCount <span class="op">=</span> vaccinationDataManager<span class="op">.</span><span class="fu">getPersonVaccinationCount</span><span class="op">(</span>personId<span class="op">);</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-29"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-29"></a>            <span class="cf">if</span> <span class="op">(</span>personVaccinationCount <span class="op">==</span> minVaccinationCount<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-30"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-30"></a>                eligiblePeople<span class="op">.</span><span class="fu">add</span><span class="op">(</span>personId<span class="op">);</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-31"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-31"></a>            <span class="op">}</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-32"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-32"></a>        <span class="op">}</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-33"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-33"></a>        <span class="cf">if</span> <span class="op">(!</span>eligiblePeople<span class="op">.</span><span class="fu">isEmpty</span><span class="op">())</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-34"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-34"></a>            selectedPersonId <span class="op">=</span> eligiblePeople<span class="op">.</span><span class="fu">get</span><span class="op">(</span>randomGenerator<span class="op">.</span><span class="fu">nextInt</span><span class="op">(</span>eligiblePeople<span class="op">.</span><span class="fu">size</span><span class="op">()));</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-35"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-35"></a>        <span class="op">}</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-36"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-36"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-37"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-37"></a>        <span class="cf">if</span> <span class="op">(!</span>peopleInRegion<span class="op">.</span><span class="fu">isEmpty</span><span class="op">())</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-38"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-38"></a>            selectedPersonId <span class="op">=</span> peopleInRegion<span class="op">.</span><span class="fu">get</span><span class="op">(</span>randomGenerator<span class="op">.</span><span class="fu">nextInt</span><span class="op">(</span>peopleInRegion<span class="op">.</span><span class="fu">size</span><span class="op">()));</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-39"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-39"></a>        <span class="op">}</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-40"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-40"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-41"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-41"></a></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-42"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-42"></a>    <span class="cf">if</span> <span class="op">(</span>selectedPersonId <span class="op">!=</span> <span class="kw">null</span><span class="op">)</span> <span class="op">{</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-43"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-43"></a>        vaccinationDataManager<span class="op">.</span><span class="fu">vaccinatePerson</span><span class="op">(</span>selectedPersonId<span class="op">);</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-44"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-44"></a>    <span class="op">}</span></span>
<span id="lst-regions_plugin_vaccinator_vaccinate_random_person-45"><a href="#lst-regions_plugin_vaccinator_vaccinate_random_person-45"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="inspecting-the-output" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="inspecting-the-output"><span class="header-section-number">8.6</span> Inspecting the output</h2>
<p>The region transfer report shows the number of transfers of a person from one region to another across all days in the simulation. The rows where the source and destination regions are the same represent the addition of people at the start of the simulation and, as expected, the sum of such transfers equals to 1000. We also expect to see regions that were added beyond the original five regions and that transfers in and out of those regions should be reduced compared to the original regions since they start out with no people and come into the simulation only after day 50.</p>
<p>no vaccinations during those periods.</p>
<div class="cell">
<div id="fig-regions_plugin_output_1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p></p><figcaption class="figure-caption">Figure&nbsp;8.1: Excerpts from the region transfer report.</figcaption><p></p>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:100%; ">

<table class="table" style="font-family: monospace; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
scenario
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
seed_index
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
seed_value
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
source_region
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
destination_region
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
transfers
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
Region_2
</td>
<td style="text-align:left;">
Region_2
</td>
<td style="text-align:left;">
215
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
Region_0
</td>
<td style="text-align:left;">
Region_0
</td>
<td style="text-align:left;">
188
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
Region_3
</td>
<td style="text-align:left;">
Region_3
</td>
<td style="text-align:left;">
208
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
Region_4
</td>
<td style="text-align:left;">
Region_4
</td>
<td style="text-align:left;">
215
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
Region_1
</td>
<td style="text-align:left;">
Region_1
</td>
<td style="text-align:left;">
174
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
Region_4
</td>
<td style="text-align:left;">
Region_3
</td>
<td style="text-align:left;">
26
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
Region_4
</td>
<td style="text-align:left;">
Region_0
</td>
<td style="text-align:left;">
36
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
Region_3
</td>
<td style="text-align:left;">
Region_4
</td>
<td style="text-align:left;">
24
</td>
</tr>
<tr>
<td style="text-align:left;">
…
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
-7320358285742045393L
</td>
<td style="text-align:left;">
Region_2
</td>
<td style="text-align:left;">
Region_2
</td>
<td style="text-align:left;">
215
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
-7320358285742045393L
</td>
<td style="text-align:left;">
Region_0
</td>
<td style="text-align:left;">
Region_0
</td>
<td style="text-align:left;">
188
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
-7320358285742045393L
</td>
<td style="text-align:left;">
Region_3
</td>
<td style="text-align:left;">
Region_3
</td>
<td style="text-align:left;">
208
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
-7320358285742045393L
</td>
<td style="text-align:left;">
Region_4
</td>
<td style="text-align:left;">
Region_4
</td>
<td style="text-align:left;">
215
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
-7320358285742045393L
</td>
<td style="text-align:left;">
Region_1
</td>
<td style="text-align:left;">
Region_1
</td>
<td style="text-align:left;">
174
</td>
</tr>
<tr>
<td style="text-align:left;">
…
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
-4619948863677044400L
</td>
<td style="text-align:left;">
Region_3
</td>
<td style="text-align:left;">
Region_0
</td>
<td style="text-align:left;">
26
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
-4619948863677044400L
</td>
<td style="text-align:left;">
Region_3
</td>
<td style="text-align:left;">
Region_1
</td>
<td style="text-align:left;">
33
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
-4619948863677044400L
</td>
<td style="text-align:left;">
Region_0
</td>
<td style="text-align:left;">
Region_4
</td>
<td style="text-align:left;">
22
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
-4619948863677044400L
</td>
<td style="text-align:left;">
Region_1
</td>
<td style="text-align:left;">
Region_4
</td>
<td style="text-align:left;">
29
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
-4619948863677044400L
</td>
<td style="text-align:left;">
Region_4
</td>
<td style="text-align:left;">
Region_0
</td>
<td style="text-align:left;">
32
</td>
</tr>
<tr>
<td style="text-align:left;">
…
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
-7584580254621783722L
</td>
<td style="text-align:left;">
Region_8
</td>
<td style="text-align:left;">
Region_4
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
-7584580254621783722L
</td>
<td style="text-align:left;">
Region_9
</td>
<td style="text-align:left;">
Region_1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
-7584580254621783722L
</td>
<td style="text-align:left;">
Region_9
</td>
<td style="text-align:left;">
Region_0
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
-7584580254621783722L
</td>
<td style="text-align:left;">
Region_9
</td>
<td style="text-align:left;">
Region_6
</td>
<td style="text-align:left;">
2
</td>
</tr>
</tbody>

</table>
</div>
</figure>
</div>
</div>
<p>In the region property report (<a href="#fig-regions_plugin_output_2">Figure&nbsp;<span>8.2</span></a>) we see that the LAT and LON properties were set for the first five regions at the start of the simulation. Starting on day 1, new regions were added and each has an assigned LAT and LON value at that time. Beginning on day 50, all regions are assigned a VACCINE_PRIOITY value and assignments to that property continue daily for random regions.</p>
<div class="cell">
<div id="fig-regions_plugin_output_2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p></p><figcaption class="figure-caption">Figure&nbsp;8.2: Excerpts from the region property report.</figcaption><p></p>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:100%; ">

<table class="table" style="font-family: monospace; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
scenario
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
seed_index
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
seed_value
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
time
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
region
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
property
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
0.0
</td>
<td style="text-align:left;">
Region_0
</td>
<td style="text-align:left;">
LAT
</td>
<td style="text-align:left;">
45.08307901948476
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
0.0
</td>
<td style="text-align:left;">
Region_0
</td>
<td style="text-align:left;">
LON
</td>
<td style="text-align:left;">
128.5497267736204
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
0.0
</td>
<td style="text-align:left;">
Region_1
</td>
<td style="text-align:left;">
LAT
</td>
<td style="text-align:left;">
45.73317078392115
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
0.0
</td>
<td style="text-align:left;">
Region_1
</td>
<td style="text-align:left;">
LON
</td>
<td style="text-align:left;">
128.98292164396958
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
0.0
</td>
<td style="text-align:left;">
Region_2
</td>
<td style="text-align:left;">
LAT
</td>
<td style="text-align:left;">
45.74702447122078
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
0.0
</td>
<td style="text-align:left;">
Region_2
</td>
<td style="text-align:left;">
LON
</td>
<td style="text-align:left;">
128.5118606592755
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
0.0
</td>
<td style="text-align:left;">
Region_3
</td>
<td style="text-align:left;">
LAT
</td>
<td style="text-align:left;">
45.8303102139607
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
0.0
</td>
<td style="text-align:left;">
Region_3
</td>
<td style="text-align:left;">
LON
</td>
<td style="text-align:left;">
128.55192626408567
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
0.0
</td>
<td style="text-align:left;">
Region_4
</td>
<td style="text-align:left;">
LAT
</td>
<td style="text-align:left;">
45.59334365958997
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
0.0
</td>
<td style="text-align:left;">
Region_4
</td>
<td style="text-align:left;">
LON
</td>
<td style="text-align:left;">
128.7915941303198
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
1.0
</td>
<td style="text-align:left;">
Region_5
</td>
<td style="text-align:left;">
LAT
</td>
<td style="text-align:left;">
35.99754757587744
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
1.0
</td>
<td style="text-align:left;">
Region_5
</td>
<td style="text-align:left;">
LON
</td>
<td style="text-align:left;">
128.2594279657217
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
21.0
</td>
<td style="text-align:left;">
Region_6
</td>
<td style="text-align:left;">
LAT
</td>
<td style="text-align:left;">
35.84682720256188
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
21.0
</td>
<td style="text-align:left;">
Region_6
</td>
<td style="text-align:left;">
LON
</td>
<td style="text-align:left;">
128.2211833000355
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
41.0
</td>
<td style="text-align:left;">
Region_7
</td>
<td style="text-align:left;">
LAT
</td>
<td style="text-align:left;">
35.07267582475035
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
41.0
</td>
<td style="text-align:left;">
Region_7
</td>
<td style="text-align:left;">
LON
</td>
<td style="text-align:left;">
128.37457313813837
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
50.0
</td>
<td style="text-align:left;">
Region_0
</td>
<td style="text-align:left;">
VACCINE_PRIORITY
</td>
<td style="text-align:left;">
false
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
50.0
</td>
<td style="text-align:left;">
Region_1
</td>
<td style="text-align:left;">
VACCINE_PRIORITY
</td>
<td style="text-align:left;">
false
</td>
</tr>
<tr>
<td style="text-align:left;">
…
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
-7584580254621783722L
</td>
<td style="text-align:left;">
93.0
</td>
<td style="text-align:left;">
Region_2
</td>
<td style="text-align:left;">
VACCINE_PRIORITY
</td>
<td style="text-align:left;">
false
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
-7584580254621783722L
</td>
<td style="text-align:left;">
94.0
</td>
<td style="text-align:left;">
Region_1
</td>
<td style="text-align:left;">
VACCINE_PRIORITY
</td>
<td style="text-align:left;">
true
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
-7584580254621783722L
</td>
<td style="text-align:left;">
95.0
</td>
<td style="text-align:left;">
Region_2
</td>
<td style="text-align:left;">
VACCINE_PRIORITY
</td>
<td style="text-align:left;">
true
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
-7584580254621783722L
</td>
<td style="text-align:left;">
96.0
</td>
<td style="text-align:left;">
Region_7
</td>
<td style="text-align:left;">
VACCINE_PRIORITY
</td>
<td style="text-align:left;">
true
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
-7584580254621783722L
</td>
<td style="text-align:left;">
97.0
</td>
<td style="text-align:left;">
Region_0
</td>
<td style="text-align:left;">
VACCINE_PRIORITY
</td>
<td style="text-align:left;">
false
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
-7584580254621783722L
</td>
<td style="text-align:left;">
98.0
</td>
<td style="text-align:left;">
Region_1
</td>
<td style="text-align:left;">
VACCINE_PRIORITY
</td>
<td style="text-align:left;">
false
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
-7584580254621783722L
</td>
<td style="text-align:left;">
99.0
</td>
<td style="text-align:left;">
Region_0
</td>
<td style="text-align:left;">
VACCINE_PRIORITY
</td>
<td style="text-align:left;">
true
</td>
</tr>
</tbody>

</table>
</div>
</figure>
</div>
</div>
<p>Finally, the vaccine report shows the number of people having various vaccine counts at the end of each simulation. Although the priority policy was being used, most vaccinations were for randomly selected people so we expect a fairly wide distribution in those values.</p>
<div class="cell">
<div id="fig-regions_plugin_output_3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p></p><figcaption class="figure-caption">Figure&nbsp;8.3: The vaccine report shows vaccine counts at the end of each simulation.</figcaption><p></p>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">

<table class="table" style="font-family: monospace; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
scenario
</th>
<th style="text-align:left;">
seed_index
</th>
<th style="text-align:left;">
seed_value
</th>
<th style="text-align:left;">
count_0
</th>
<th style="text-align:left;">
count_1
</th>
<th style="text-align:left;">
count_2
</th>
<th style="text-align:left;">
count_3
</th>
<th style="text-align:left;">
count_4
</th>
<th style="text-align:left;">
count_5
</th>
<th style="text-align:left;">
count_6+
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
-7834265884293137617L
</td>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
67
</td>
<td style="text-align:left;">
145
</td>
<td style="text-align:left;">
168
</td>
<td style="text-align:left;">
170
</td>
<td style="text-align:left;">
148
</td>
<td style="text-align:left;">
289
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
-7320358285742045393L
</td>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
63
</td>
<td style="text-align:left;">
141
</td>
<td style="text-align:left;">
181
</td>
<td style="text-align:left;">
187
</td>
<td style="text-align:left;">
133
</td>
<td style="text-align:left;">
282
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
-4619948863677044400L
</td>
<td style="text-align:left;">
17
</td>
<td style="text-align:left;">
53
</td>
<td style="text-align:left;">
157
</td>
<td style="text-align:left;">
196
</td>
<td style="text-align:left;">
176
</td>
<td style="text-align:left;">
140
</td>
<td style="text-align:left;">
261
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
3282202756261196294L
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
72
</td>
<td style="text-align:left;">
159
</td>
<td style="text-align:left;">
166
</td>
<td style="text-align:left;">
163
</td>
<td style="text-align:left;">
146
</td>
<td style="text-align:left;">
284
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
-7584580254621783722L
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
66
</td>
<td style="text-align:left;">
153
</td>
<td style="text-align:left;">
198
</td>
<td style="text-align:left;">
163
</td>
<td style="text-align:left;">
136
</td>
<td style="text-align:left;">
280
</td>
</tr>
</tbody>

</table>
</div>
</figure>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ch07-PeoplePlugin.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">People Plugin</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ch09-PersonPropertiesPlugin.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Person Properties Plugin</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>